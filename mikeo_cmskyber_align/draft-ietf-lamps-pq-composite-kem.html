<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Composite ML-KEM for Use in the Internet X.509 Public Key Infrastructure and CMS</title>
<meta content="Mike Ounsworth" name="author">
<meta content="John Gray" name="author">
<meta content="Massimiliano Pala" name="author">
<meta content="Jan Klaussner" name="author">
<meta content="Scott Fluhrer" name="author">
<meta content="
       This document defines combinations of ML-KEM   in hybrid with traditional algorithms RSA-OAEP, ECDH, X25519, and X448. For use within CMS, this document is intended to be coupled with the CMS KEMRecipientInfo mechanism in  . These combinations are tailored to meet security best practices and regulatory requirements. Composite ML-KEM is applicable in any application that uses X.509, PKIX, and CMS data structures and protocols that would otherwise use ML-KEM, but wants the protection against breaks or catastrophic bugs in ML-KEM. 
       



    " name="description">
<meta content="xml2rfc 3.23.2" name="generator">
<meta content="X.509" name="keyword">
<meta content="CMS" name="keyword">
<meta content="Post-Quantum" name="keyword">
<meta content="KEM" name="keyword">
<meta content="draft-ietf-lamps-pq-composite-kem-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.2
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-lamps-pq-composite-kem.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Composite ML-KEM</td>
<td class="right">October 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Ounsworth, et al.</td>
<td class="center">Expires 22 April 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">LAMPS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-lamps-pq-composite-kem-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-10-19" class="published">19 October 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-04-22">22 April 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Ounsworth</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">J. Gray</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">M. Pala</div>
<div class="org">OpenCA Labs</div>
</div>
<div class="author">
      <div class="author-name">J. Klaussner</div>
<div class="org">Bundesdruckerei GmbH</div>
</div>
<div class="author">
      <div class="author-name">S. Fluhrer</div>
<div class="org">Cisco Systems</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Composite ML-KEM for Use in the Internet X.509 Public Key Infrastructure and CMS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines combinations of ML-KEM <span>[<a href="#FIPS.203" class="cite xref">FIPS.203</a>]</span> in hybrid with traditional algorithms RSA-OAEP, ECDH, X25519, and X448. For use within CMS, this document is intended to be coupled with the CMS KEMRecipientInfo mechanism in <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>. These combinations are tailored to meet security best practices and regulatory requirements. Composite ML-KEM is applicable in any application that uses X.509, PKIX, and CMS data structures and protocols that would otherwise use ML-KEM, but wants the protection against breaks or catastrophic bugs in ML-KEM.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://lamps-wg.github.io/draft-composite-kem/draft-ietf-lamps-pq-composite-kem.html#name-asn1-module">https://lamps-wg.github.io/draft-composite-kem/draft-ietf-lamps-pq-composite-kem.html#name-asn1-module</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-pq-composite-kem/">https://datatracker.ietf.org/doc/draft-ietf-lamps-pq-composite-kem/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        LAMPS Working Group mailing list (<span><a href="mailto:spams@ietf.org">mailto:spams@ietf.org</a></span>),
        which is archived at <span><a href="https://datatracker.ietf.org/wg/lamps/about/">https://datatracker.ietf.org/wg/lamps/about/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/spams/">https://www.ietf.org/mailman/listinfo/spams/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/lamps-wg/draft-composite-kem">https://github.com/lamps-wg/draft-composite-kem</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 22 April 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-changes-in-version-05" class="internal xref">Changes in version -05</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-composite-design-philosophy" class="internal xref">Composite Design Philosophy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-composite-key-encapsulation" class="internal xref">Composite Key Encapsulation Mechanisms (KEMs)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-composite-keygen" class="internal xref">Composite KeyGen</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-promotion-of-rsa-oaep-into-" class="internal xref">Promotion of RSA-OAEP into a KEM</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="auto internal xref">2.3.3</a>.  <a href="#name-promotion-of-ecdh-into-a-ke" class="internal xref">Promotion of ECDH into a KEM</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.4">
                    <p id="section-toc.1-1.2.2.3.2.4.1"><a href="#section-2.3.4" class="auto internal xref">2.3.4</a>.  <a href="#name-kem-combiner" class="internal xref">KEM Combiner</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.5">
                    <p id="section-toc.1-1.2.2.3.2.5.1"><a href="#section-2.3.5" class="auto internal xref">2.3.5</a>.  <a href="#name-composite-encap" class="internal xref">Composite Encap</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.6">
                    <p id="section-toc.1-1.2.2.3.2.6.1"><a href="#section-2.3.6" class="auto internal xref">2.3.6</a>.  <a href="#name-composite-decap" class="internal xref">Composite Decap</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.7">
                    <p id="section-toc.1-1.2.2.3.2.7.1"><a href="#section-2.3.7" class="auto internal xref">2.3.7</a>.  <a href="#name-decapsulation-failure" class="internal xref">Decapsulation failure</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-composite-key-structures" class="internal xref">Composite Key Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-pk-compositekem" class="internal xref">pk-CompositeKEM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-compositekempublickey" class="internal xref">CompositeKEMPublicKey</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-compositekemprivatekey" class="internal xref">CompositeKEMPrivateKey</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-encoding-rules" class="internal xref">Encoding Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-key-usage-bits" class="internal xref">Key Usage Bits</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-composite-ml-kem-structures" class="internal xref">Composite ML-KEM Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-kema-compositekem" class="internal xref">kema-CompositeKEM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-compositeciphertextvalue" class="internal xref">CompositeCiphertextValue</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-algorithm-identifiers" class="internal xref">Algorithm Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-rationale-for-choices" class="internal xref">Rationale for choices</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-domain-separators" class="internal xref">Domain Separators</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-rsa-oaep-parameters" class="internal xref">RSA-OAEP Parameters</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-use-in-cms" class="internal xref">Use in CMS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-recipientinfo-conventions" class="internal xref">RecipientInfo Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-underlying-components" class="internal xref">Underlying Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-use-of-the-hkdf-based-key-d" class="internal xref">Use of the HKDF-based Key Derivation Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-use-of-the-kmac-based-key-d" class="internal xref">Use of the KMAC-based Key Derivation Function</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-components-for-composite-ml" class="internal xref">Components for Composite ML-KEM in CMS</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-recipientinfo-conventions-2" class="internal xref">RecipientInfo Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-certificate-conventions" class="internal xref">Certificate Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-smimecapabilities-attribute" class="internal xref">SMIMECapabilities Attribute Conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-asn1-module" class="internal xref">ASN.1 Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-object-identifier-allocatio" class="internal xref">Object Identifier Allocations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-module-registration-smi-sec" class="internal xref">Module Registration - SMI Security for PKIX Module Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="auto internal xref">8.1.2</a>.  <a href="#name-object-identifier-registrat" class="internal xref">Object Identifier Registrations - SMI Security for PKIX Algorithms</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-kem-combiner-security-analy" class="internal xref">KEM Combiner Security Analysis</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-second-pre-image-resistance" class="internal xref">Second pre-image resistance of componet KEMs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="auto internal xref">9.1.2</a>.  <a href="#name-sha3-vs-hkdf-sha2" class="internal xref">SHA3 vs HKDF-SHA2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#section-9.1.3" class="auto internal xref">9.1.3</a>.  <a href="#name-generifying-this-constructi" class="internal xref">Generifying this construction</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.4">
                    <p id="section-toc.1-1.9.2.1.2.4.1"><a href="#section-9.1.4" class="auto internal xref">9.1.4</a>.  <a href="#name-key-reuse" class="internal xref">Key Reuse</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-policy-for-deprecated-and-a" class="internal xref">Policy for Deprecated and Acceptable Algorithms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-samples" class="internal xref">Samples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-fixed-component-algorithm-i" class="internal xref">Fixed Component Algorithm Identifiers</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-fips-certification" class="internal xref">FIPS Certification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.1">
                    <p id="section-toc.1-1.13.2.1.2.1.1"><a href="#appendix-C.1.1" class="auto internal xref">C.1.1</a>.  <a href="#name-fips-certification-of-combi" class="internal xref">FIPS certification of Combiner Function</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-backwards-compatibility" class="internal xref">Backwards Compatibility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-decapsulation-requires-the-" class="internal xref">Decapsulation Requires the Public Key</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-intellectual-property-consi" class="internal xref">Intellectual Property Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-contributors-and-acknowledg" class="internal xref">Contributors and Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="changes-in-version-05">
<section id="section-1">
      <h2 id="name-changes-in-version-05">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-changes-in-version-05" class="section-name selfRef">Changes in version -05</a>
      </h2>
<p id="section-1-1">Interop-affecting changes:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">
          <p id="section-1-2.1.1">Fixed a bug in the definition of the Encaps() functions: KEMs, according to both RFC9180 and FIPS 203 should always return (ss, ct), but we had (ct, ss).<a href="#section-1-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-2.2">
          <p id="section-1-2.2.1">Interoperable composite private key format requires component public keys (because public keys are required for decapsulation).<a href="#section-1-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-2.3">
          <p id="section-1-2.3.1">Specified that the tradCT and tradPK inputs to the KEM combiner must be the raw values without the OCTET STRING wrapper.<a href="#section-1-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-3">Editorial changes:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">
          <p id="section-1-4.1.1">Added an Implementation Consideration section explaining why private keys need to contain the public keys.<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.2">
          <p id="section-1-4.2.1">Added a security consideration about key reuse.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.3">
          <p id="section-1-4.3.1">Added security considerations about SHA3-vs-HKDF-SHA2 and a warning against generifying this construction to other combinations of ciphers.<a href="#section-1-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.4">
          <p id="section-1-4.4.1">Fixed a bug in the definition of the Encap() functions: KEMs, according to both RFC9180 and FIPS 203 should always return (ss, ct), but we had (ct, ss).<a href="#section-1-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.5">
          <p id="section-1-4.5.1">Adjusted RSA-OAEP section to follow RFC8017 instead of RFC3560. Does not use the RSA-OAEP label.<a href="#section-1-4.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.6">
          <p id="section-1-4.6.1">Aligning algorithm list with LAMPS WG on-list discussions and draft-openpgp-pqc<a href="#section-1-4.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.6.2.1">
              <p id="section-1-4.6.2.1.1">ML-KEM-768 aligned with P-384 as per Quynh's OpenPGP presentation: https://datatracker.ietf.org/meeting/120/materials/slides-120-openpgp-pqc-with-nist-and-brainpool-curves<a href="#section-1-4.6.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.6.2.2">
              <p id="section-1-4.6.2.2.1">Removing ML-KEM-512 combinations as per Sophie's recommendation: https://mailarchive.ietf.org/arch/msg/spasm/khasPf3y0_-Lq_0NtJe92unUw6o/<a href="#section-1-4.6.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-1-4.7">
          <p id="section-1-4.7.1">Specified some options to use HKDF-SHA2, and some to use SHA3 to facilitate implementations that do not have easy access to SHA3 outside the ML-KEM module.<a href="#section-1-4.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.8">
          <p id="section-1-4.8.1">Tweaks to combiner function, thanks to Quynh and authors of draft-ietf-openpgp-PQC:<a href="#section-1-4.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.8.2.1">
              <p id="section-1-4.8.2.1.1">Removed the <code>counter</code>.<a href="#section-1-4.8.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.8.2.2">
              <p id="section-1-4.8.2.2.1">Un-twisted <code>tradSS || mlkemSS</code> to <code>mlkemSS || tradSS</code> as you would expect (thanks Quynh for pointing that this is allowed).<a href="#section-1-4.8.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1-4.8.2.3">
              <p id="section-1-4.8.2.3.1">Simplified to use 256-bit hashes at all security levels (HKDF-SHA256, SHA3-256, KMAC128), which matches ML-KEM's 256 bit shared secret key at all levels.<a href="#section-1-4.8.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-1-4.9">
          <p id="section-1-4.9.1">Enhanced the section about how to get this FIPS-certified.<a href="#section-1-4.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.10">
          <p id="section-1-4.10.1">Updated OIDs and domain separators.<a href="#section-1-4.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-4.11">
          <p id="section-1-4.11.1">ASN.1 module fixes (thanks Russ).<a href="#section-1-4.11.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-5">Still to do in a future version:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">
          <p id="section-1-6.1.1"><code>[ ]</code> We need PEM samples … hackathon? OQS friends? David @ BC? The right format for samples is probably to follow the hackathon ... a Dilithium or ECDSA trust anchor certificate, a composite KEM end entity certificate, and a CMS EnvelopedData sample encrypted for that composite KEM certificate.<a href="#section-1-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-6.2">
          <p id="section-1-6.2.1"><code>[ ]</code> Open question: do we need to include the ECDH, X25519, X448, and RSA public keys in the KDF? X-Wing does, but previous versions of this spec do not. In general existing ECC and RSA hardware decrypter implementations might not know their own public key.<a href="#section-1-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-intro">
<section id="section-2">
      <h2 id="name-introduction">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-2-1">The advent of quantum computing poses a significant threat to current cryptographic systems. Traditional cryptographic algorithms such as RSA-OAEP, ECDH and their elliptic curve variants are vulnerable to quantum attacks. During the transition to post-quantum cryptography (PQC), there is considerable uncertainty regarding the robustness of both existing and new cryptographic algorithms. While we can no longer fully trust traditional cryptography, we also cannot immediately place complete trust in post-quantum replacements until they have undergone extensive scrutiny and real-world testing to uncover and rectify potential implementation flaws.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Unlike previous migrations between cryptographic algorithms, the decision of when to migrate and which algorithms to adopt is far from straightforward. Even after the migration period, it may be advantageous for an entity's cryptographic identity to incorporate multiple public-key algorithms to enhance security.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Cautious implementers may opt to combine cryptographic algorithms in such a way that an attacker would need to break all of them simultaneously to compromise the protected data. These mechanisms are referred to as Post-Quantum/Traditional (PQ/T) Hybrids <span>[<a href="#I-D.ietf-pquip-pqt-hybrid-terminology" class="cite xref">I-D.ietf-pquip-pqt-hybrid-terminology</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Certain jurisdictions are already recommending or mandating that PQC lattice schemes be used exclusively within a PQ/T hybrid framework. The use of Composite scheme provides a straightforward implementation of hybrid solutions compatible with (and advocated by) some governments and cybersecurity agencies <span>[<a href="#BSI2021" class="cite xref">BSI2021</a>]</span>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">In addition, <span>[<a href="#BSI2021" class="cite xref">BSI2021</a>]</span> specifically references this specification as a concrete example of hybrid X.509 certificates.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">A more recent example is <span>[<a href="#ANSSI2024" class="cite xref">ANSSI2024</a>]</span>, a document co-authored by French Cybersecurity Agency (ANSSI),
Federal Office for Information Security (BSI), Netherlands National Communications Security Agency (NLNCSA), and
Swedish National Communications Security Authority, Swedish Armed Forces which makes the following statement:<a href="#section-2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-7.1">
          <p id="section-2-7.1.1">“In light of the urgent need to stop relying only on quantum-vulnerable public-key cryptography for key establishment, the clear priority should therefore be the migration to post-quantum cryptography in hybrid solutions”<a href="#section-2-7.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-8">This specification represents the straightforward implementation of the hybrid solutions called for by European cyber security agencies.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">PQ/T Hybrid cryptography can, in general, provide solutions to two migration problems:<a href="#section-2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-10.1">
          <p id="section-2-10.1.1">Algorithm strength uncertainty: During the transition period, some post-quantum signature and encryption algorithms will not be fully trusted, while also the trust in legacy public key algorithms will start to erode.  A relying party may learn some time after deployment that a public key algorithm has become untrustworthy, but in the interim, they may not know which algorithm an adversary has compromised.<a href="#section-2-10.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-10.2">
          <p id="section-2-10.2.1">Ease-of-migration: During the transition period, systems will require mechanisms that allow for staged migrations from fully classical to fully post-quantum-aware cryptography.<a href="#section-2-10.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-11">This document defines a specific instantiation of the PQ/T Hybrid paradigm called "composite" where multiple cryptographic algorithms are combined to form a single key encapsulation mechanism (KEM) key and ciphertext such that they can be treated as a single atomic algorithm at the protocol level. Composite algorithms address algorithm strength uncertainty because the composite algorithm remains strong so long as one of its components remains strong. Concrete instantiations of composite ML-KEM algorithms are provided based on ML-KEM, RSA-OAEP and ECDH. Backwards compatibility is not directly covered in this document, but is the subject of <a href="#sec-backwards-compat" class="auto internal xref">Appendix C.2</a>.<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">Composite ML-KEM is intended for general applicability anywhere that key establishment or enveloped content encryption is used within PKIX or CMS structures.<a href="#section-2-12" class="pilcrow">¶</a></p>
<div id="sec-terminology">
<section id="section-2.1">
        <h3 id="name-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-2.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>  <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">This document is consistent with all terminology from <span>[<a href="#I-D.ietf-pquip-pqt-hybrid-terminology" class="cite xref">I-D.ietf-pquip-pqt-hybrid-terminology</a>]</span>.
In addition, the following terms are used in this document:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3"><strong>COMBINER:</strong>
  A combiner specifies how multiple shared secrets are combined into
  a single shared secret.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4"><strong>DER:</strong>
  Distinguished Encoding Rules as defined in <span>[<a href="#X.690" class="cite xref">X.690</a>]</span>.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5"><strong>KEM:</strong>
   A key encapsulation mechanism as defined in <a href="#sec-kems" class="auto internal xref">Section 2.3</a>.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6"><strong>PKI:</strong>
  Public Key Infrastructure, as defined in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7"><strong>SHARED SECRET:</strong>
  A value established between two communicating parties for use as
  cryptographic key material, but which cannot be learned by an active
  or passive adversary. This document is concerned with shared
  secrets established via public key cryptographic operations.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="composite-design-philosophy">
<section id="section-2.2">
        <h3 id="name-composite-design-philosophy">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-composite-design-philosophy" class="section-name selfRef">Composite Design Philosophy</a>
        </h3>
<p id="section-2.2-1"><span>[<a href="#I-D.ietf-pquip-pqt-hybrid-terminology" class="cite xref">I-D.ietf-pquip-pqt-hybrid-terminology</a>]</span> defines composites as:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.2-2.1">
            <p id="section-2.2-2.1.1"><em>Composite Cryptographic Element</em>:  A cryptographic element that
     incorporates multiple component cryptographic elements of the same
     type in a multi-algorithm scheme.<a href="#section-2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-3">Composite keys, as defined here, follow this definition and should be regarded as a single key that performs a single cryptographic operation such as key generation, signing, verifying, encapsulating, or decapsulating -- using its internal sequence of component keys as if they form a single key. This generally means that the complexity of combining algorithms can and should be handled by the cryptographic library or cryptographic module, and the single composite public key, private key, and ciphertext can be carried in existing fields in protocols such as PKCS#10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>, CMP <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span>, X.509 <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, CMS <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, and the Trust Anchor Format <span>[<a href="#RFC5914" class="cite xref">RFC5914</a>]</span>. In this way, composites achieve "protocol backwards-compatibility" in that they will drop cleanly into any protocol that accepts KEM algorithms without requiring any modification of the protocol to handle multiple keys.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-kems">
<section id="section-2.3">
        <h3 id="name-composite-key-encapsulation">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-composite-key-encapsulation" class="section-name selfRef">Composite Key Encapsulation Mechanisms (KEMs)</a>
        </h3>
<p id="section-2.3-1">We borrow here the definition of a key encapsulation mechanism (KEM) from <span>[<a href="#I-D.ietf-tls-hybrid-design" class="cite xref">I-D.ietf-tls-hybrid-design</a>]</span>, in which a KEM is a cryptographic primitive that consists of three algorithms:<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">
            <p id="section-2.3-2.1.1"><code>KeyGen() -&gt; (pk, sk)</code>: A probabilistic key generation algorithm,
which generates a public key <code>pk</code> and a secret key <code>sk</code>.<a href="#section-2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.2">
            <p id="section-2.3-2.2.1"><code>Encap(pk) -&gt; (ss, ct)</code>: A probabilistic encapsulation algorithm,
which takes as input a public key <code>pk</code> and outputs a ciphertext <code>ct</code>
and shared secret ss. Note: this document uses <code>Encap()</code> to conform to <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
but <span>[<a href="#FIPS.203" class="cite xref">FIPS.203</a>]</span> uses <code>Encaps()</code>.<a href="#section-2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.3">
            <p id="section-2.3-2.3.1"><code>Decap(sk, ct) -&gt; ss</code>: A decapsulation algorithm, which takes as
input a secret key <code>sk</code> and ciphertext <code>ct</code> and outputs a shared
secret <code>ss</code>, or in some cases a distinguished error value.
Note: this document uses <code>Decap()</code> to conform to <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>,
but <span>[<a href="#FIPS.203" class="cite xref">FIPS.203</a>]</span> uses <code>Decaps()</code>.<a href="#section-2.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.3-3">The KEM interface defined above differs from both traditional key transport mechanism (for example for use with KeyTransRecipientInfo defined in <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>), and key agreement (for example for use with KeyAgreeRecipientInfo defined in <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>).<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">The KEM interface was chosen as the interface for a composite key establishment because it allows for arbitrary combinations of component algorithm types since both key transport and key agreement mechanisms can be promoted into KEMs. This specification uses the Post-Quantum KEM ML-KEM as specified in <span>[<a href="#I-D.ietf-lamps-kyber-certificates" class="cite xref">I-D.ietf-lamps-kyber-certificates</a>]</span> and <span>[<a href="#FIPS.203" class="cite xref">FIPS.203</a>]</span>. For Traditional KEMs, this document uses the RSA-OAEP algorithm defined in <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>, the Elliptic Curve Diffie-Hellman key agreement schemes ECDH defined in section 5.7.1.2 of <span>[<a href="#SP.800-56Ar3" class="cite xref">SP.800-56Ar3</a>]</span>, and X25519 / X448 which are defined in <span>[<a href="#RFC8410" class="cite xref">RFC8410</a>]</span>. A combiner function is used to combine the two component shared secrets into a single shared secret.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<div id="composite-keygen">
<section id="section-2.3.1">
          <h4 id="name-composite-keygen">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-composite-keygen" class="section-name selfRef">Composite KeyGen</a>
          </h4>
<p id="section-2.3.1-1">The <code>KeyGen() -&gt; (pk, sk)</code> of a composite ML-KEM algorithm will perform the <code>KeyGen()</code> of the respective component KEM algorithms and it produces a composite public key <code>pk</code> as per <a href="#sec-composite-pub-keys" class="auto internal xref">Section 3.2</a> and a composite secret key <code>sk</code> as per <a href="#sec-priv-key" class="auto internal xref">Section 3.3</a>.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.1-2">
<pre>
CompositeKEM.KeyGen():
  (compositePK[0], compositeSK[0]) = MLKEM.KeyGen()
  (compositePK[1], compositeSK[1]) = TradKEM.KeyGen()

  return (compositePK, compositeSK)
</pre><a href="#section-2.3.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="promotion-of-rsa-oaep-into-a-kem">
<section id="section-2.3.2">
          <h4 id="name-promotion-of-rsa-oaep-into-">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-promotion-of-rsa-oaep-into-" class="section-name selfRef">Promotion of RSA-OAEP into a KEM</a>
          </h4>
<p id="section-2.3.2-1">The RSA Optimal Asymmetric Encryption Padding (OAEP), as defined in section 7.1 of <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> is a public key encryption algorithm used to transport key material from a sender to a receiver. It is promoted into a KEM by having the sender generate a random 256 bit secret and encrypt it.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.2-2">
<pre>
RSAOAEPKEM.Encap(pkR):
  shared_secret = SecureRandom(ss_len)
  enc = RSAES-OAEP-ENCRYPT(pkR, shared_secret)

  return shared_secret, enc
</pre><a href="#section-2.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3.2-3">Note that the OAEP label <code>L</code> is left to its default value, which is the empty string as per <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>. The shared secret output by the overall Composite ML-KEM already binds a composite domain separator, so there is no need to also utilize the component domain separators.<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<p id="section-2.3.2-4">The value of <code>ss_len</code> as well as the RSA-OAEP parameters used within this specification can be found in <a href="#sect-rsaoaep-params" class="auto internal xref">Section 5.3</a>.<a href="#section-2.3.2-4" class="pilcrow">¶</a></p>
<p id="section-2.3.2-5"><code>Decap(sk, ct) -&gt; ss</code> is accomplished in the analogous way.<a href="#section-2.3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.2-6">
<pre>
RSAOAEPKEM.Decap(skR, enc):
  shared_secret = RSAES-OAEP-DECRYPT(skR, enc)

  return shared_secret
</pre><a href="#section-2.3.2-6" class="pilcrow">¶</a>
</div>
<p id="section-2.3.2-7">Note that, at least at the time of writing, the algorithm <code>RSAOAEPKEM</code> is not defined as a standalone algorithm within PKIX standards and it does not have an assigned algorithm OID, so it connot be used directly with CMS KEMRecipientInfo <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>; it is merely a building block for the composite algorithm.<a href="#section-2.3.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="promotion-of-ecdh-into-a-kem">
<section id="section-2.3.3">
          <h4 id="name-promotion-of-ecdh-into-a-ke">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-promotion-of-ecdh-into-a-ke" class="section-name selfRef">Promotion of ECDH into a KEM</a>
          </h4>
<p id="section-2.3.3-1">An elliptic curve Diffie-Hellman key agreement is promoted into a KEM <code>Encap(pk) -&gt; (ss, ct)</code> using a simplified version of the DHKEM definition from <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.3-2">
<pre>
DHKEM.Encap(pkR):
  skE, pkE = GenerateKeyPair()
  shared_secret = DH(skE, pkR)
  enc = SerializePublicKey(pkE)

  return shared_secret, enc
</pre><a href="#section-2.3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3.3-3"><code>Decap(sk, ct) -&gt; ss</code> is accomplished in the analogous way.<a href="#section-2.3.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.3-4">
<pre>
DHKEM.Decap(skR, enc):
  pkE = DeserializePublicKey(enc)
  shared_secret = DH(skR, pkE)

  return shared_secret
</pre><a href="#section-2.3.3-4" class="pilcrow">¶</a>
</div>
<p id="section-2.3.3-5">This construction applies for all variants of elliptic curve Diffie-Hellman used in this specification: ECDH, X25519, and X448.<a href="#section-2.3.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3.3-6">The simplifications from the DHKEM definition in <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span> is that since the ciphertext and receiver's public key are included explicitly in the Composite ML-KEM combiner, there is no need to construct the <code>kem_context</code> object, and since a domain separator is included explicitly in the Composite ML-KEM combiner there is no need to perform the labelled steps of <code>ExtractAndExpand()</code>.<a href="#section-2.3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-kem-combiner">
<section id="section-2.3.4">
          <h4 id="name-kem-combiner">
<a href="#section-2.3.4" class="section-number selfRef">2.3.4. </a><a href="#name-kem-combiner" class="section-name selfRef">KEM Combiner</a>
          </h4>
<p id="section-2.3.4-1">TODO: as per https://www.enisa.europa.eu/publications/post-quantum-cryptography-integration-study section 4.2, might need to specify behaviour in light of KEMs with a non-zero failure probability.<a href="#section-2.3.4-1" class="pilcrow">¶</a></p>
<p id="section-2.3.4-2">The KEM combiner construction is as follows:<a href="#section-2.3.4-2" class="pilcrow">¶</a></p>
<span id="name-generic-kem-combiner-constr"></span><div id="code-generic-kem-combiner">
<figure id="figure-1">
            <div class="alignLeft art-text artwork" id="section-2.3.4-3.1">
<pre>
Combiner(mlkemSS, tradSS, tradCT, tradPK, domSep) :

  return KDF(mlkemSS || tradSS || tradCT || tradPK || domSep)
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-generic-kem-combiner-constr" class="selfRef">Generic KEM combiner construction</a>
            </figcaption></figure>
</div>
<p id="section-2.3.4-4">where:<a href="#section-2.3.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.4-5.1">
              <p id="section-2.3.4-5.1.1"><code>KDF(message)</code> represents a key derivation function suitable to the chosen KEMs according to {tab-kem-combiners}. All KDFs are specified with a fixed output length.<a href="#section-2.3.4-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-5.2">
              <p id="section-2.3.4-5.2.1"><code>mlkemSS</code> is the shared secret from the ML-KEM componont.<a href="#section-2.3.4-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-5.3">
              <p id="section-2.3.4-5.3.1"><code>tradSS</code> is the shared secret from the traditional component (elliptic curve or RSA).<a href="#section-2.3.4-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-5.4">
              <p id="section-2.3.4-5.4.1"><code>tradCT</code> is the ciphertext from the traditional component (elliptic curve or RSA).<a href="#section-2.3.4-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-5.5">
              <p id="section-2.3.4-5.5.1"><code>tradPK</code> is the public key of the traditional component (elliptic curve or RSA).<a href="#section-2.3.4-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-5.6">
              <p id="section-2.3.4-5.6.1"><code>domSep</code> SHALL be the DER encoded value of the object identifier of the Composite ML-KEM algorithm as listed in <a href="#sec-domain" class="auto internal xref">Section 5.2</a>.<a href="#section-2.3.4-5.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.3.4-5.7">
              <p id="section-2.3.4-5.7.1"><code>||</code> represents concatenation.<a href="#section-2.3.4-5.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.3.4-6">Each registered Composite ML-KEM algorithm specifies the choice of <code>KDF</code>, <code>demSep</code> to be used in <a href="#sec-alg-ids" class="auto internal xref">Section 5</a> and <a href="#sec-domain" class="auto internal xref">Section 5.2</a> below. Given that each Composite ML-KEM algorithm fully specifies the component algorithms, including for example the size of the RSA modulus, all inputs to the KEM combiner are fixed-size and thus do not require length-prefixing. The <code>CompositeKEM.Decap()</code> specified in <a href="#sect-composite-decaps" class="auto internal xref">Section 2.3.6</a> adds further error handling to protect the KEM combiner from malicious inputs.<a href="#section-2.3.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="composite-encap">
<section id="section-2.3.5">
          <h4 id="name-composite-encap">
<a href="#section-2.3.5" class="section-number selfRef">2.3.5. </a><a href="#name-composite-encap" class="section-name selfRef">Composite Encap</a>
          </h4>
<p id="section-2.3.5-1">Note that, at least at the time of writing, the algorithm <code>DHKEM</code> is not defined as a standalone algorithm within PKIX standards and it does not have an assigned algorithm OID, so it connot be used directly with CMS KEMRecipientInfo <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>; it is merely a building block for the composite algorithm.<a href="#section-2.3.5-1" class="pilcrow">¶</a></p>
<p id="section-2.3.5-2">The <code>Encap(pk) -&gt; (ss, ct)</code> of a Composite ML-KEM algorithm is defined as:<a href="#section-2.3.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.5-3">
<pre>
CompositeKEM.Encap(pk):
  # Split the component public keys
  mlkemPK = pk[0]
  tradPK  = pk[1]

  # Perform the respective component Encap operations
  (mlkemCT, mlkemSS) = MLKEM.Encaps(mlkemPK)
  (tradCT, tradSS) = TradKEM.Encap(tradPK)

  # Combine
  # note that the order of the traditional and ML-KEM components
  # is flipped here in order to satisfy NIST SP800-56Cr2.
  ct = CompositeCiphertextValue(mlkemCT, tradCT)
  ss = Combiner(mlkemSS, tradSS, tradCT, tradPK, domSep)

  return (ss, ct)
</pre><a href="#section-2.3.5-3" class="pilcrow">¶</a>
</div>
<p id="section-2.3.5-4">where <code>Combiner(tradSS, mlkemSS, tradCT, tradPK, domSep)</code> is defined in general in <a href="#sec-kem-combiner" class="auto internal xref">Section 2.3.4</a> with specific values for <code>domSep</code> per Composite ML-KEM algorithm in <a href="#sec-alg-ids" class="auto internal xref">Section 5</a> and <code>CompositeCiphertextValue</code> is defined in <a href="#sec-CompositeCiphertextValue" class="auto internal xref">Section 4.2</a>.<a href="#section-2.3.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-composite-decaps">
<section id="section-2.3.6">
          <h4 id="name-composite-decap">
<a href="#section-2.3.6" class="section-number selfRef">2.3.6. </a><a href="#name-composite-decap" class="section-name selfRef">Composite Decap</a>
          </h4>
<p id="section-2.3.6-1">The <code>Decap(sk, ct) -&gt; ss</code> of a Composite ML-KEM algorithm is defined as:<a href="#section-2.3.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.6-2">
<pre>
CompositeKEM.Decap(ct, mlkemSK, tradSK):
  # split the component ciphertexts
  mlkemCT = ct[0]
  tradCT  = ct[1]

  # Perform the respective component Decap operations
  mlkemSS = MLKEM.Decaps(mlkemSK, mlkemCT)
  tradSS  = TradKEM.Decap(tradSK, tradCT)

  # Combine
  # note that the order of the traditional and ML-KEM components
  # is flipped here in order to satisfy NIST SP800-56Cr2.
  ss = Combiner(mlkemSS, tradSS, tradCT, tradPK, domSep)

  return ss
</pre><a href="#section-2.3.6-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3.6-3">where <code>Combiner(tradSS, mlkemSS, tradCT, tradPK, domSep)</code> is defined in general in <a href="#sec-kem-combiner" class="auto internal xref">Section 2.3.4</a> with specific values for <code>domSep</code> per Composite ML-KEM algorithm in <a href="#sec-alg-ids" class="auto internal xref">Section 5</a>. <code>CompositeCiphertextValue</code> is defined in <a href="#sec-CompositeCiphertextValue" class="auto internal xref">Section 4.2</a>.<a href="#section-2.3.6-3" class="pilcrow">¶</a></p>
<p id="section-2.3.6-4">Here the secret key values <code>mlkemSK</code> and <code>tradSK</code> may be interpreted as either literal secret key values, or as a handle to a cryptographic module which holds the secret key and is capable of performing the secret key operation.<a href="#section-2.3.6-4" class="pilcrow">¶</a></p>
<p id="section-2.3.6-5">In order to properly achieve its security properties, the KEM combiner requires that all inputs are fixed-length. Since each Composite ML-KEM algorithm fully specifies its component algorithms, including key sizes, all inputs are generally fixed-length, however some implementations may need to perform additional checking to handle certain error conditions. In particular, the KEM combiner step should not be performed if either of the component decapsulations returned an error condition indicating malformed inputs -- for timing-invariance reasons, it is recommended to perform both decapsulation operations and check for errors afterwards to make it less easy for an attacker to tell which component failed. Also, RSA-based composites MUST ensure that the modulus size (ie the size of tradCT and tradPK) matches that specified for the given Composite ML-KEM algorithm in <a href="#tab-kem-algs" class="auto internal xref">Table 2</a>; depending on the cryptographic library used, this check may be done by the library or may require an explicit check as part of the <code>CompositeKEM.Decap()</code> routine.<a href="#section-2.3.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decapsulation-failure">
<section id="section-2.3.7">
          <h4 id="name-decapsulation-failure">
<a href="#section-2.3.7" class="section-number selfRef">2.3.7. </a><a href="#name-decapsulation-failure" class="section-name selfRef">Decapsulation failure</a>
          </h4>
<p id="section-2.3.7-1">Provided all inputs are well-formed, the key establishment procedure of ML-KEM will never explicitly fail. Specifically, the ML-KEM.Encaps and ML-KEM.Decaps algorithms from <span>[<a href="#FIPS.203" class="cite xref">FIPS.203</a>]</span> will always output a value with the same data type as a shared secret key, and will never output an error or failure symbol. However, it is possible (though extremely unlikely) that the process will fail in the sense that ML-KEM.Encaps and ML-KEM.Decaps will produce different outputs, even though both of them are behaving honestly and no adversarial interference is present. In this case, the sender and recipient clearly did not succeed in producing a shared secret key. This event is called a decapsulation failure. Estimates for the decapsulation failure probability (or rate) for each of the ML-KEM parameter sets are provided in Table 1  of <span>[<a href="#FIPS.203" class="cite xref">FIPS.203</a>]</span> and reproduced here in <a href="#tab-mlkem-failure-rate" class="auto internal xref">Table 1</a>.<a href="#section-2.3.7-1" class="pilcrow">¶</a></p>
<span id="name-ml-kem-decapsulation-failur"></span><div id="tab-mlkem-failure-rate">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-ml-kem-decapsulation-failur" class="selfRef">ML-KEM decapsulation failure rates</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Parameter set</th>
                <th class="text-left" rowspan="1" colspan="1">Decapsulation failure rate</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ML-KEM-512</td>
                <td class="text-left" rowspan="1" colspan="1">2^(-139)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ML-KEM-768</td>
                <td class="text-left" rowspan="1" colspan="1">2^(-164)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ML-KEM-1024</td>
                <td class="text-left" rowspan="1" colspan="1">2^(-174)</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-2.3.7-3">In the case of ML-KEM decapsulation failure, Composite ML-KEM MUST preserve the same behaviour and return a well-formed output.<a href="#section-2.3.7-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-composite-keys">
<section id="section-3">
      <h2 id="name-composite-key-structures">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-composite-key-structures" class="section-name selfRef">Composite Key Structures</a>
      </h2>
<div id="pk-compositekem">
<section id="section-3.1">
        <h3 id="name-pk-compositekem">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-pk-compositekem" class="section-name selfRef">pk-CompositeKEM</a>
        </h3>
<p id="section-3.1-1">The following ASN.1 Information Object Class is a template to be used in defining all Composite ML-KEM public key types.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="lang-ASN.1 sourcecode" id="section-3.1-2">
<pre>
pk-CompositeKEM {
  OBJECT IDENTIFIER:id, FirstPublicKeyType,
  SecondPublicKeyType} PUBLIC-KEY ::=
  {
    IDENTIFIER id
    KEY SEQUENCE {
     BIT STRING (CONTAINING FirstPublicKeyType)
     BIT STRING (CONTAINING SecondPublicKeyType)
    }
    PARAMS ARE absent
    CERT-KEY-USAGE { keyEncipherment }
  }
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">As an example, the public key type <code>pk-MLKEM512-ECDH-P256</code> is defined as:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-4">
<pre>
pk-MLKEM512-ECDH-P256 PUBLIC-KEY ::=
  pk-CompositeKEM {
    id-MLKEM512-ECDH-P256,
    OCTET STRING, ECPoint }
</pre><a href="#section-3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.1-5">The full set of key types defined by this specification can be found in the ASN.1 Module in <a href="#sec-asn1-module" class="auto internal xref">Section 7</a>.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-composite-pub-keys">
<section id="section-3.2">
        <h3 id="name-compositekempublickey">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-compositekempublickey" class="section-name selfRef">CompositeKEMPublicKey</a>
        </h3>
<p id="section-3.2-1">Composite public key data is represented by the following structure:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div class="lang-ASN.1 sourcecode" id="section-3.2-2">
<pre>
CompositeKEMPublicKey ::= SEQUENCE SIZE (2) OF BIT STRING
</pre><a href="#section-3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.2-3">A composite key MUST contain two component public keys as SEQUENCE of two bit strings. The order of the component keys is determined by the definition of the corresponding algorithm identifier as defined in section <a href="#sec-alg-ids" class="auto internal xref">Section 5</a>.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Some applications may need to reconstruct the <code>SubjectPublicKeyInfo</code> objects corresponding to each component public key. <a href="#tab-kem-algs" class="auto internal xref">Table 2</a> in <a href="#sec-alg-ids" class="auto internal xref">Section 5</a> provides the necessary mapping between composite and their component algorithms for doing this reconstruction. This also motivates the design choice of <code>SEQUENCE OF BIT STRING</code> instead of <code>SEQUENCE OF OCTET STRING</code>; using <code>BIT STRING</code> allows for easier transcription between CompositeKEMPublicKey and SubjectPublicKeyInfo.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">When the CompositeKEMPublicKey must be provided in octet string or bit string format, the data structure is encoded as specified in <a href="#sec-encoding-rules" class="auto internal xref">Section 3.4</a>.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">In order to maintain security properties of the composite, applications that use composite keys MUST always perform fresh key generations of both component keys and MUST NOT reuse existing key material. See <a href="#sec-cons-key-reuse" class="auto internal xref">Section 9.1.4</a> for a discussion.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-priv-key">
<section id="section-3.3">
        <h3 id="name-compositekemprivatekey">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-compositekemprivatekey" class="section-name selfRef">CompositeKEMPrivateKey</a>
        </h3>
<p id="section-3.3-1">Use cases that require an inter-operable encoding for composite private keys, such as when private keys are carried in PKCS #12 <span>[<a href="#RFC7292" class="cite xref">RFC7292</a>]</span>, CMP <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span> or CRMF <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> MUST use the following structure.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div class="lang-ASN.1 sourcecode" id="section-3.3-2">
<pre>
CompositeKEMPrivateKey ::= SEQUENCE SIZE (2) OF OneAsymmetricKey
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.3-3">Each element is a <code>OneAsymmetricKey</code> <span>[<a href="#RFC5958" class="cite xref">RFC5958</a>]</span> object for a component private key.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">The parameters field MUST be absent.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">The order of the component keys is the same as the order defined in <a href="#sec-composite-pub-keys" class="auto internal xref">Section 3.2</a> for the components of CompositeKEMPublicKey.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">Often, a <code>CompositePrivateKey</code> will be carried within a carrier format such as PKCS#8 which is itself a <code>OneAsymmetricKey</code> structure (version 1 of which is also known as PrivateKeyInfo) <span>[<a href="#RFC5958" class="cite xref">RFC5958</a>]</span>, then a situation arises where we have <code>CompositeKEMPrivateKey ::= SEQUENCE SIZE (2) OF OneAsymmetricKey</code> inside another <code>OneAsymmetricKey</code>. On the outer <code>OneAsymmetricKey</code>, the <code>privateKeyAlgorithm</code> field SHALL be set to the corresponding composite algorithm identifier defined according to <a href="#sec-alg-ids" class="auto internal xref">Section 5</a>, the <code>privateKey</code> field SHALL contain the <code>CompositeKEMPrivateKey</code>, and the <code>publicKey</code> field MUST NOT be present. As discussed in <a href="#impl-cons-decaps-pubkey" class="auto internal xref">Appendix C.3</a>, the ML-KEM private key encoding already includes a copy of the public key, so the <code>publicKey</code> field of the first <code>OneAsymmetricKey</code> remains OPTIONAL. However, the public key of the traditional component, RSA or Elliptic Curve, is required as input to the KEM Combiner function, and is not typically carried within an RSA or Elliptic Curve private key. Therefore the <code>publicKey</code> field of the second <code>OneAsymmetricKey</code> MUST contain the corresponding public key. See <a href="#impl-cons-decaps-pubkey" class="auto internal xref">Appendix C.3</a> for more discussion. Which <code>AlgorithmID</code>s to place into the component <code>OneAsymmetricKey</code>s is ambiguous; since <code>OneAsymmetricKey.PrivateKeyAlgorithmIdentifier.AlgorithmID</code> is not optional, producers MUST place something here and MAY either duplicate the composite AlgorithmID into both components, or MAY place the AlgorithmID of the component algorithm. Parsers SHOULD ignore the component private key <code>AlgorithmID</code>s and assume that the private keys are in the same order as specified in <a href="#tab-kem-algs" class="auto internal xref">Table 2</a>.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">In some use-cases the private keys that comprise a composite key may not be represented in a single structure or even be contained in a single cryptographic module; for example if one component is within the FIPS boundary of a cryptographic module and the other is not; see <a href="#sec-fips" class="auto internal xref">Appendix C.1</a> for more discussion. The establishment of correspondence between public keys in a CompositeKEMPublicKey and private keys not represented in a single composite structure is beyond the scope of this document.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-encoding-rules">
<section id="section-3.4">
        <h3 id="name-encoding-rules">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-encoding-rules" class="section-name selfRef">Encoding Rules</a>
        </h3>
<p id="section-3.4-1">Many protocol specifications will require that the composite public key and composite private key data structures be represented by an octet string or bit string.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">When an octet string is required, the DER encoding of the composite data structure SHALL be used directly.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<div class="lang-ASN.1 sourcecode" id="section-3.4-3">
<pre>
CompositeKEMPublicKeyOs ::= OCTET STRING (CONTAINING CompositeKEMPublicKey ENCODED BY der)
</pre><a href="#section-3.4-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4-4">When a bit string is required, the octets of the DER encoded composite data structure SHALL be used as the bits of the bit string, with the most significant bit of the first octet becoming the first bit, and so on, ending with the least significant bit of the last octet becoming the last bit of the bit string.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<div class="lang-ASN.1 sourcecode" id="section-3.4-5">
<pre>
CompositeKEMPublicKeyBs ::= BIT STRING (CONTAINING CompositeKEMPublicKey ENCODED BY der)
</pre><a href="#section-3.4-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="key-usage-bits">
<section id="section-3.5">
        <h3 id="name-key-usage-bits">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-key-usage-bits" class="section-name selfRef">Key Usage Bits</a>
        </h3>
<p id="section-3.5-1">For protocols such as X.509 <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> that specify key usage along with the public key, then the composite public key associated with a Composite ML-KEM algorithm MUST contain only a <code>keyEncipherment</code> key usage, all other key usages MUST NOT be used.
This is because the composite public key can only be used in situations
that are appropriate for both component algorithms, so even if the
classical component key supports both signing and encryption,
the post-quantum algorithms do not.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="composite-ml-kem-structures">
<section id="section-4">
      <h2 id="name-composite-ml-kem-structures">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-composite-ml-kem-structures" class="section-name selfRef">Composite ML-KEM Structures</a>
      </h2>
<div id="sec-kema-CompositeKEM">
<section id="section-4.1">
        <h3 id="name-kema-compositekem">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-kema-compositekem" class="section-name selfRef">kema-CompositeKEM</a>
        </h3>
<p id="section-4.1-1">The ASN.1 algorithm object for a Composite ML-KEM is:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
kema-CompositeKEM {
  OBJECT IDENTIFIER:id,
    PUBLIC-KEY:publicKeyType }
    KEM-ALGORITHM ::= {
         IDENTIFIER id
         VALUE CompositeCiphertextValue
         PARAMS ARE absent
         PUBLIC-KEYS { publicKeyType }
        }
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-CompositeCiphertextValue">
<section id="section-4.2">
        <h3 id="name-compositeciphertextvalue">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-compositeciphertextvalue" class="section-name selfRef">CompositeCiphertextValue</a>
        </h3>
<p id="section-4.2-1">The compositeCipherTextValue is a SEQUENCE of the ciphertexts of the
underlying component algorithms.  It is represented in ASN.1 as follows:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-2">
<pre>
CompositeCiphertextValue ::= SEQUENCE SIZE (2) OF OCTET STRING
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3">The order of the component ciphertexts is the same as the order defined in <a href="#sec-composite-pub-keys" class="auto internal xref">Section 3.2</a>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Some of the design choices for the combiner, specifically to place <code>tradSS</code> first, and to allow <code>tradCT || tradPK || domSep</code> to be treated together as a FixedInfo block are made for the purposes of compliance with <span>[<a href="#SP.800-56Cr2" class="cite xref">SP.800-56Cr2</a>]</span>; see <a href="#sec-fips" class="auto internal xref">Appendix C.1</a> for more discussion.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">See <a href="#sec-cons-kem-combiner" class="auto internal xref">Section 9.1</a> for further discussion of the security considerations of this KEM combiner.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-alg-ids">
<section id="section-5">
      <h2 id="name-algorithm-identifiers">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-algorithm-identifiers" class="section-name selfRef">Algorithm Identifiers</a>
      </h2>
<p id="section-5-1">This table summarizes the list of Composite ML-KEM algorithms and lists the OID, two component algorithms, and the combiner function.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">EDNOTE: The OID referenced are TBD and MUST be used only for prototyping and replaced with the final IANA-assigned OIDs.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">TODO: OIDs to be replaced by IANA.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">&lt;CompKEM&gt;.1 is equal to 2.16.840.1.114027.80.5.2.1<a href="#section-5-4" class="pilcrow">¶</a></p>
<span id="name-composite-ml-kem-key-types"></span><div id="tab-kem-algs">
<table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-composite-ml-kem-key-types" class="selfRef">Composite ML-KEM key types</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Composite ML-KEM Algorithm</th>
            <th class="text-left" rowspan="1" colspan="1">OID</th>
            <th class="text-left" rowspan="1" colspan="1">First Algorithm</th>
            <th class="text-left" rowspan="1" colspan="1">Second Algorithm</th>
            <th class="text-left" rowspan="1" colspan="1">KDF</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-RSA2048</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;CompKEM&gt;.21</td>
            <td class="text-left" rowspan="1" colspan="1">MLKEM768</td>
            <td class="text-left" rowspan="1" colspan="1">RSA-OAEP 2048</td>
            <td class="text-left" rowspan="1" colspan="1">HKDF-SHA256/256</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-RSA3072</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;CompKEM&gt;.22</td>
            <td class="text-left" rowspan="1" colspan="1">MLKEM768</td>
            <td class="text-left" rowspan="1" colspan="1">RSA-OAEP 3072</td>
            <td class="text-left" rowspan="1" colspan="1">HKDF-SHA256/256</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-RSA4096</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;CompKEM&gt;.23</td>
            <td class="text-left" rowspan="1" colspan="1">MLKEM768</td>
            <td class="text-left" rowspan="1" colspan="1">RSA-OAEP 4096</td>
            <td class="text-left" rowspan="1" colspan="1">HKDF-SHA256/256</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-X25519</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;CompKEM&gt;.24</td>
            <td class="text-left" rowspan="1" colspan="1">MLKEM768</td>
            <td class="text-left" rowspan="1" colspan="1">X25519</td>
            <td class="text-left" rowspan="1" colspan="1">SHA3-256</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-ECDH-P384</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;CompKEM&gt;.25</td>
            <td class="text-left" rowspan="1" colspan="1">MLKEM768</td>
            <td class="text-left" rowspan="1" colspan="1">ECDH-P384</td>
            <td class="text-left" rowspan="1" colspan="1">HKDF-SHA256/256</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-ECDH-brainpoolP256r1</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;CompKEM&gt;.26</td>
            <td class="text-left" rowspan="1" colspan="1">MLKEM768</td>
            <td class="text-left" rowspan="1" colspan="1">ECDH-brainpoolp256r1</td>
            <td class="text-left" rowspan="1" colspan="1">HKDF-SHA256/256</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-MLKEM1024-ECDH-P384</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;CompKEM&gt;.27</td>
            <td class="text-left" rowspan="1" colspan="1">MLKEM1024</td>
            <td class="text-left" rowspan="1" colspan="1">ECDH-P384</td>
            <td class="text-left" rowspan="1" colspan="1">SHA3-256</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-MLKEM1024-ECDH-brainpoolP384r1</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;CompKEM&gt;.28</td>
            <td class="text-left" rowspan="1" colspan="1">MLKEM1024</td>
            <td class="text-left" rowspan="1" colspan="1">ECDH-brainpoolP384r1</td>
            <td class="text-left" rowspan="1" colspan="1">SHA3-256</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">id-MLKEM1024-X448</td>
            <td class="text-left" rowspan="1" colspan="1">&lt;CompKEM&gt;.29</td>
            <td class="text-left" rowspan="1" colspan="1">MLKEM1024</td>
            <td class="text-left" rowspan="1" colspan="1">X448</td>
            <td class="text-left" rowspan="1" colspan="1">SHA3-256</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-5-6">Full specifications for the referenced algorithms can be found as follows:<a href="#section-5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-7.1">
          <p id="section-5-7.1.1"><em>ECDH</em>: There does not appear to be a single IETF definition of ECDH, so we refer to the following:<a href="#section-5-7.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-7.1.2.1">
              <p id="section-5-7.1.2.1.1"><em>ECDH NIST</em>: SHALL be Elliptic Curve Cryptography Cofactor Diffie-Hellman (ECC CDH) as defined in section 5.7.1.2 of <span>[<a href="#SP.800-56Ar3" class="cite xref">SP.800-56Ar3</a>]</span>.<a href="#section-5-7.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5-7.1.2.2">
              <p id="section-5-7.1.2.2.1"><em>ECDH BSI / brainpool</em>: SHALL be Elliptic Curve Key Agreement algorithm (ECKA) as defined in section 4.3.1 of <span>[<a href="#BSI-ECC" class="cite xref">BSI-ECC</a>]</span><a href="#section-5-7.1.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-5-7.2">
          <p id="section-5-7.2.1"><em>ML-KEM</em>: <span>[<a href="#I-D.ietf-lamps-kyber-certificates" class="cite xref">I-D.ietf-lamps-kyber-certificates</a>]</span> and <span>[<a href="#FIPS.203" class="cite xref">FIPS.203</a>]</span><a href="#section-5-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.3">
          <p id="section-5-7.3.1"><em>RSA-OAEP</em>: <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span><a href="#section-5-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.4">
          <p id="section-5-7.4.1"><em>X25519 / X448</em>: <span>[<a href="#RFC8410" class="cite xref">RFC8410</a>]</span><a href="#section-5-7.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.5">
          <p id="section-5-7.5.1"><em>HKDF</em>: <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span>. Salt is not provided; ie the default salt (all zeroes of length HashLen) will be used. In all cases, the output length of HKDF is the same as the block size of the underlying hash function, for example <code>HKDF-SHA256/256</code> means HKDF-SHA256 with an output length <code>L</code> of 256 bits (32 octets).<a href="#section-5-7.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.6">
          <p id="section-5-7.6.1"><em>SHA2</em>: <span>[<a href="#FIPS.180-4" class="cite xref">FIPS.180-4</a>]</span><a href="#section-5-7.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-7.7">
          <p id="section-5-7.7.1"><em>SHA3</em>: <span>[<a href="#FIPS.202" class="cite xref">FIPS.202</a>]</span><a href="#section-5-7.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="rationale-for-choices">
<section id="section-5.1">
        <h3 id="name-rationale-for-choices">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-rationale-for-choices" class="section-name selfRef">Rationale for choices</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-5.1-1.1">
            <p id="section-5.1-1.1.1">Pair equivalent levels.<a href="#section-5.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.2">
            <p id="section-5.1-1.2.1">NIST-P-384 is CNSA approved <span>[<a href="#CNSA2.0" class="cite xref">CNSA2.0</a>]</span> for all classification levels.<a href="#section-5.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.3">
            <p id="section-5.1-1.3.1">521 bit curve not widely used.<a href="#section-5.1-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.1-2">A single invocation of SHA3 is known to behave as a dual-PRF, and thus is sufficient for use as a KDF, see <a href="#sec-cons-kem-combiner" class="auto internal xref">Section 9.1</a>, however SHA2 is not us must be wrapped in the HKDF construction.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The lower security levels are provided with HKDF-SHA2 as the KDF in order to facilitate implementations that do not have easy access to SHA3 outside of the ML-KEM function. Higher security levels are paired with SHA3 for computational efficiency, and the Edwards Curve (X25519 and X448) combinations are paired with SHA3 for compatibility with other similar spicifications.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">While it may seem odd to use 256-bit hash functions at all security levels, this aligns with ML-KEM which produces a 256-bit shared secret key at all security levels. SHA-256, SHA3-256, KMAC128 all have &gt;= 256 bits of (2nd) preimage resistance, which is the required property for a KDF to provide 128 bits of security, as allowed in Table 3 of <span>[<a href="#SP.800-57pt1r5" class="cite xref">SP.800-57pt1r5</a>]</span>.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-domain">
<section id="section-5.2">
        <h3 id="name-domain-separators">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-domain-separators" class="section-name selfRef">Domain Separators</a>
        </h3>
<p id="section-5.2-1">The KEM combiner defined in section <a href="#sec-kem-combiner" class="auto internal xref">Section 2.3.4</a> requires a domain separator <code>domSep</code> input.  The following table shows the HEX-encoded domain separator for each Composite ML-KEM AlgorithmID; to use it, the value should be HEX-decoded and used in binary form. The domain separator is simply the DER encoding of the composite algorithm OID.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span id="name-composite-ml-kem-fixedinfo-"></span><div id="tab-kem-domains">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-composite-ml-kem-fixedinfo-" class="selfRef">Composite ML-KEM fixedInfo Domain Separators</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Composite ML-KEM Algorithm</th>
              <th class="text-left" rowspan="1" colspan="1">Domain Separator (in Hex encoding)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-RSA2048</td>
              <td class="text-left" rowspan="1" colspan="1">060B6086480186FA6B50050215</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-RSA3072</td>
              <td class="text-left" rowspan="1" colspan="1">060B6086480186FA6B50050216</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-RSA4096</td>
              <td class="text-left" rowspan="1" colspan="1">060B6086480186FA6B50050217</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-X25519</td>
              <td class="text-left" rowspan="1" colspan="1">060B6086480186FA6B5005021A</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-ECDH-P384</td>
              <td class="text-left" rowspan="1" colspan="1">060B6086480186FA6B50050218</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-ECDH-brainpoolP256r1</td>
              <td class="text-left" rowspan="1" colspan="1">060B6086480186FA6B50050219</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id-MLKEM1024-ECDH-P384</td>
              <td class="text-left" rowspan="1" colspan="1">060B6086480186FA6B5005021B</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id-MLKEM1024-ECDH-brainpoolP384r1</td>
              <td class="text-left" rowspan="1" colspan="1">060B6086480186FA6B5005021C</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">id-MLKEM1024-X448</td>
              <td class="text-left" rowspan="1" colspan="1">060B6086480186FA6B5005021D</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.2-3">EDNOTE: these domain separators are based on the prototyping OIDs assigned on the Entrust arc. We will need to ask for IANA early allocation of these OIDs so that we can re-compute the domain separators over the final OIDs.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-rsaoaep-params">
<section id="section-5.3">
        <h3 id="name-rsa-oaep-parameters">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-rsa-oaep-parameters" class="section-name selfRef">RSA-OAEP Parameters</a>
        </h3>
<p id="section-5.3-1">Use of RSA-OAEP <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> within <code>id-MLKEM768-RSA2048</code>, <code>id-MLKEM768-RSA3072</code>, and <code>id-MLKEM768-RSA4096</code> requires additional specification.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">First, a quick note on the choice of RSA-OAEP as the supported RSA encryption primitive. RSA-KEM <span>[<a href="#RFC5990" class="cite xref">RFC5990</a>]</span> is more straightforward to work with, but it has fairly limited adoption and therefore is of limited backwards compatibility value. Also, while RSA-PKCS#1v1.5 <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> is still everywhere, but hard to make secure and no longer FIPS-approved as of the end of 2023 <span>[<a href="#SP800-131Ar2" class="cite xref">SP800-131Ar2</a>]</span>, so it is of limited forwards value. This leaves RSA-OAEP <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> as the remaining choice.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">The RSA component keys MUST be generated at the 2048-bit and 3072-bit security levels respectively.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">As with the other Composite ML-KEM algorithms, when <code>id-MLKEM512-RSA2048</code> or <code>id-MLKEM512-RSA3072</code> is used in an AlgorithmIdentifier, the parameters MUST be absent. The RSA-OAEP SHALL be instantiated with the following hard-coded parameters which are the same for both the 2048 and 3072 bit security levels.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<span id="name-rsa-oaep-parameters-2"></span><div id="rsa-oaep-params">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-rsa-oaep-parameters-2" class="selfRef">RSA-OAEP Parameters</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">RSAES-OAEP-params</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">hashAlgorithm</td>
              <td class="text-left" rowspan="1" colspan="1">id-sha2-256</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">maskGenAlgorithm</td>
              <td class="text-left" rowspan="1" colspan="1">mgf1SHA256Identifier</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">pSourceAlgorithm</td>
              <td class="text-left" rowspan="1" colspan="1">pSpecifiedEmpty</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ss_len</td>
              <td class="text-left" rowspan="1" colspan="1">256 bits</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.3-6">where:<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-7.1">
            <p id="section-5.3-7.1.1"><code>id-sha256</code> is defined in <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>.<a href="#section-5.3-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-7.2">
            <p id="section-5.3-7.2.1"><code>mgf1SHA256Identifier</code> is defined in <span>[<a href="#RFC4055" class="cite xref">RFC4055</a>]</span>, which refers to the MFG1 function defined in <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> appendix B.2.1.<a href="#section-5.3-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.3-7.3">
            <p id="section-5.3-7.3.1"><code>pSpecifiedEmpty</code> is defined in <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span> to indicate that the empty string is used for the label.<a href="#section-5.3-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.3-8">Note: The mask length, according to <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>, is <code>k - hLen - 1</code>, where <code>k</code> is the size of the RSA modulus. Since the choice of hash function and the RSA key size is fixed for each composite algorithm, implementations could choose to pre-compute and hard-code the mask length.<a href="#section-5.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="use-in-cms">
<section id="section-6">
      <h2 id="name-use-in-cms">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-use-in-cms" class="section-name selfRef">Use in CMS</a>
      </h2>
<p id="section-6-1">[EDNOTE: The convention in LAMPS is to specify algorithms and their CMS conventions in separate documents. Here we have presented them in the same document, but this section has been written so that it can easily be moved to a standalone document.]<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Composite ML-KEM algorithms MAY be employed for one or more recipients in the CMS enveloped-data content type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, the CMS authenticated-data content type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, or the CMS authenticated-enveloped-data content type <span>[<a href="#RFC5083" class="cite xref">RFC5083</a>]</span>. In each case, the KEMRecipientInfo <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span> is used with the chosen Composite ML-KEM Algorithm to securely transfer the content-encryption key from the originator to the recipient.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">All recommendations for using Composite ML-KEM in CMS are fully aligned with the use of ML-KEM in CMS <span>[<a href="#I-D.ietf-lamps-cms-kyber" class="cite xref">I-D.ietf-lamps-cms-kyber</a>]</span>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="sec-using-recipientInfo">
<section id="section-6.1">
        <h3 id="name-recipientinfo-conventions">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-recipientinfo-conventions" class="section-name selfRef">RecipientInfo Conventions</a>
        </h3>
<p id="section-6.1-1">When Composite ML-KEM is employed for a recipient, the RecipientInfo alternative for that recipient MUST be OtherRecipientInfo using the KEMRecipientInfo structure as defined in <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The fields of the KEMRecipientInfo MUST have the following values:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1-3.1">
            <p id="section-6.1-3.1.1">version is the syntax version number; it MUST be 0.<a href="#section-6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1-4.1">
            <p id="section-6.1-4.1.1">rid identifies the recipient's certificate or public key.<a href="#section-6.1-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1-5.1">
            <p id="section-6.1-5.1.1">kem identifies the KEM algorithm; it MUST contain one of the Composite ML-KEM identifiers listed in <a href="#sec-alg-ids" class="auto internal xref">Section 5</a>.<a href="#section-6.1-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1-6.1">
            <p id="section-6.1-6.1.1">kemct is the ciphertext produced for this recipient.<a href="#section-6.1-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1-7.1">
            <p id="section-6.1-7.1.1">kdf identifies the key-derivation algorithm. Note that the Key Derivation Function (KDF) used for CMS RecipientInfo process MAY be different than the KDF used within the Composite ML-KEM algorithm or one of its components.<a href="#section-6.1-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1-8.1">
            <p id="section-6.1-8.1.1">kekLength is the size of the key-encryption key in octets.<a href="#section-6.1-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1-9.1">
            <p id="section-6.1-9.1.1">ukm is an optional random input to the key-derivation function. ML-KEM doesn't place any requirements on the ukm contents.<a href="#section-6.1-9.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.1-10.1">
            <p id="section-6.1-10.1.1">wrap identifies a key-encryption algorithm used to encrypt the content-encryption key.<a href="#section-6.1-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="underlying-components">
<section id="section-6.2">
        <h3 id="name-underlying-components">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-underlying-components" class="section-name selfRef">Underlying Components</a>
        </h3>
<p id="section-6.2-1">When a particular Composite ML-KEM OID is supported, a CMS implementation MUST support the corresponding KDF and key-encryption algorithms listed in <a href="#tab-cms-kdf-wrap" class="auto internal xref">Table 5</a>, which have been chosen to preserve security and performance characteristics of each composite algorithm.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="use-of-the-hkdf-based-key-derivation-function">
<section id="section-6.2.1">
          <h4 id="name-use-of-the-hkdf-based-key-d">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-use-of-the-hkdf-based-key-d" class="section-name selfRef">Use of the HKDF-based Key Derivation Function</a>
          </h4>
<p id="section-6.2.1-1">The HMAC-based Extract-and-Expand Key Derivation Function (HKDF) is defined in <span>[<a href="#RFC5869" class="cite xref">RFC5869</a>]</span>.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">The HKDF function is a composition of the HKDF-Extract and HKDF-Expand functions.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-3">
<pre>
HKDF(salt, IKM, info, L)
  = HKDF-Expand(HKDF-Extract(salt, IKM), info, L)
</pre><a href="#section-6.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-4">HKDF(salt, IKM, info, L) takes the following parameters:<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2.1-5">
            <dt id="section-6.2.1-5.1">salt:</dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-5.2">
              <p id="section-6.2.1-5.2.1">optional salt value (a non-secret random value). In this document this parameter is unused, that is it is the zero-length string "".<a href="#section-6.2.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-5.3">IKM:</dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-5.4">
              <p id="section-6.2.1-5.4.1">input keying material. In this document this is the shared secret outputted from the Encapsulate() or Decapsulate() functions.  This corresponds to the IKM KDF input from <span><a href="https://rfc-editor.org/rfc/rfc9629#section-5" class="relref">Section 5</a> of [<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>.<a href="#section-6.2.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-5.5">info:</dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-5.6">
              <p id="section-6.2.1-5.6.1">optional context and application specific information. In this document this corresponds to the info KDF input from <span><a href="https://rfc-editor.org/rfc/rfc9629#section-5" class="relref">Section 5</a> of [<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>. This is the ASN.1 DER encoding of CMSORIforKEMOtherInfo.<a href="#section-6.2.1-5.6.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-5.7">L:</dt>
            <dd style="margin-left: 1.5em" id="section-6.2.1-5.8">
              <p id="section-6.2.1-5.8.1">length of output keying material in octets. This corresponds to the L KDF input from <span><a href="https://rfc-editor.org/rfc/rfc9629#section-5" class="relref">Section 5</a> of [<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>, which is identified in the kekLength value from KEMRecipientInfo. Implementations MUST confirm that this value is consistent with the key size of the key-encryption algorithm.<a href="#section-6.2.1-5.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.2.1-6">HKDF may be used with different hash functions, including SHA-256 <span>[<a href="#FIPS.180-4" class="cite xref">FIPS.180-4</a>]</span>. The object identifier id-alg-hkdf-with-sha256 is defined in <span>[<a href="#RFC8619" class="cite xref">RFC8619</a>]</span>, and specifies the use of HKDF with SHA-256. The parameter field MUST be absent when this algorithm identifier is used to specify the KDF for ML-KEM in KemRecipientInfo.<a href="#section-6.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-the-kmac-based-key-derivation-function">
<section id="section-6.2.2">
          <h4 id="name-use-of-the-kmac-based-key-d">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-use-of-the-kmac-based-key-d" class="section-name selfRef">Use of the KMAC-based Key Derivation Function</a>
          </h4>
<p id="section-6.2.2-1">KMAC128-KDF is a KMAC-based KDF specified for use in CMS in <span>[<a href="#I-D.ietf-lamps-cms-sha3-hash" class="cite xref">I-D.ietf-lamps-cms-sha3-hash</a>]</span>. The definition of KMAC is copied here for convenience.  Here, KMAC# indicates the use of either KMAC128-KDF or KMAC256-KDF, although only KMAC128 is used in this specification.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2.2-2">KMAC#(K, X, L, S) takes the following parameters:<a href="#section-6.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.2-3.1">
              <p id="section-6.2.2-3.1.1">K: the input key-derivation key.  In this document this is the shared secret outputted from the Encapsulate() or Decapsulate() functions.  This corresponds to the IKM KDF input from Section 5 of <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>.<a href="#section-6.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.2-4.1">
              <p id="section-6.2.2-4.1.1">X: the context, corresponding to the info KDF input from Section 5 of <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>. This is the ASN.1 DER encoding of CMSORIforKEMOtherInfo.<a href="#section-6.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.2-5.1">
              <p id="section-6.2.2-5.1.1">L: the output length, in bits.  This corresponds to the L KDF input from Section 5 of <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>, which is identified in the kekLength value from KEMRecipientInfo.  The L KDF input and kekLength values are specified in octets while this L parameter is specified in bits.<a href="#section-6.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.2-6.1">
              <p id="section-6.2.2-6.1.1">S: the optional customization label.  In this document this parameter is unused, that is it is the zero-length string "".<a href="#section-6.2.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.2-7">The object identifier for KMAC128-KDF is id-kmac128, as defined in <span>[<a href="#I-D.ietf-lamps-cms-sha3-hash" class="cite xref">I-D.ietf-lamps-cms-sha3-hash</a>]</span>.<a href="#section-6.2.2-7" class="pilcrow">¶</a></p>
<p id="section-6.2.2-8">Since the customization label to KMAC# is not used, the parameter field MUST be absent when id-kmac128 is used as part of an algorithm identifier specifying the KDF to use for Composite ML-KEM in KemRecipientInfo.<a href="#section-6.2.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="components-for-composite-ml-kem-in-cms">
<section id="section-6.2.3">
          <h4 id="name-components-for-composite-ml">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-components-for-composite-ml" class="section-name selfRef">Components for Composite ML-KEM in CMS</a>
          </h4>
<p id="section-6.2.3-1">A compliant implementation MUST support the following algorithm combinations for the KEMRecipientInfo <code>kdf</code> and <code>wrap</code> fields when the corresponding Composite ML-KEM algorithm is listed in the KEMRecipientInfo <code>kem</code> field. The KDFs listed below align with the KDF used internally within the KEM combiner. An implementation MAY also support other key-derivation functions and other key-encryption algorithms within CMS KEMRecipientInfo.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<span id="name-mandatory-to-implement-pair"></span><div id="tab-cms-kdf-wrap">
<table class="center" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-mandatory-to-implement-pair" class="selfRef">Mandatory-to-implement pairings for CMS KDF and WRAP</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Composite ML-KEM Algorithm</th>
                <th class="text-left" rowspan="1" colspan="1">KDF</th>
                <th class="text-left" rowspan="1" colspan="1">Wrap</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-RSA2048</td>
                <td class="text-left" rowspan="1" colspan="1">id-alg-hkdf-with-sha256</td>
                <td class="text-left" rowspan="1" colspan="1">id-aes128-wrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-RSA3072</td>
                <td class="text-left" rowspan="1" colspan="1">id-alg-hkdf-with-sha256</td>
                <td class="text-left" rowspan="1" colspan="1">id-aes128-wrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-RSA4096</td>
                <td class="text-left" rowspan="1" colspan="1">id-alg-hkdf-with-sha256</td>
                <td class="text-left" rowspan="1" colspan="1">id-aes128-wrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-X25519</td>
                <td class="text-left" rowspan="1" colspan="1">id-kmac128</td>
                <td class="text-left" rowspan="1" colspan="1">id-aes128-wrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-ECDH-P384</td>
                <td class="text-left" rowspan="1" colspan="1">id-alg-hkdf-with-sha256</td>
                <td class="text-left" rowspan="1" colspan="1">id-aes256-wrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id-MLKEM768-ECDH-brainpoolP256r1</td>
                <td class="text-left" rowspan="1" colspan="1">id-alg-hkdf-with-sha256</td>
                <td class="text-left" rowspan="1" colspan="1">id-aes256-wrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id-MLKEM1024-ECDH-P384</td>
                <td class="text-left" rowspan="1" colspan="1">id-kmac128</td>
                <td class="text-left" rowspan="1" colspan="1">id-aes256-wrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id-MLKEM1024-ECDH-brainpoolP384r1</td>
                <td class="text-left" rowspan="1" colspan="1">id-kmac128</td>
                <td class="text-left" rowspan="1" colspan="1">id-aes256-wrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">id-MLKEM1024-X448</td>
                <td class="text-left" rowspan="1" colspan="1">id-kmac128</td>
                <td class="text-left" rowspan="1" colspan="1">id-aes256-wrap</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-6.2.3-3">where:<a href="#section-6.2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.3-4.1">
              <p id="section-6.2.3-4.1.1"><code>id-alg-hkdf-with-sha256</code> is defined in <span>[<a href="#RFC8619" class="cite xref">RFC8619</a>]</span>.<a href="#section-6.2.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.3-4.2">
              <p id="section-6.2.3-4.2.1"><code>id-kmac128</code> is defined in <span>[<a href="#I-D.ietf-lamps-cms-sha3-hash" class="cite xref">I-D.ietf-lamps-cms-sha3-hash</a>]</span>.<a href="#section-6.2.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.2.3-4.3">
              <p id="section-6.2.3-4.3.1"><code>id-aes*-wrap</code> are defined in <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span>.<a href="#section-6.2.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.2.3-5">Note that here we differ slightly from the internal KDF used within the KEM combiner in <a href="#sec-alg-ids" class="auto internal xref">Section 5</a> because <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span> requires that the KDF listed in the KEMRecipientInfo <code>kdf</code> field must have an interface which accepts <code>KDF(IKM, L, info)</code>, so here we need to use KMAC and cannot directly use SHA3.<a href="#section-6.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="recipientinfo-conventions">
<section id="section-6.3">
        <h3 id="name-recipientinfo-conventions-2">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-recipientinfo-conventions-2" class="section-name selfRef">RecipientInfo Conventions</a>
        </h3>
<p id="section-6.3-1">When a Composite ML-KEM Algorithm is employed for a recipient, the RecipientInfo alternative for that recipient MUST be OtherRecipientInfo using the KEMRecipientInfo structure <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>. The fields of the KEMRecipientInfo MUST have the following values:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2"><code>version</code> is the syntax version number; it MUST be 0.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3"><code>rid</code> identifies the recipient's certificate or public key.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4"><code>kem</code> identifies the KEM algorithm; it MUST contain one of the OIDs listed in <a href="#tab-kem-algs" class="auto internal xref">Table 2</a>.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5"><code>kemct</code> is the ciphertext produced for this recipient; it contains the <code>ct</code> output from <code>Encap(pk)</code> of the KEM algorithm identified in the <code>kem</code> parameter.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6"><code>kdf</code> identifies the key-derivation function (KDF). Note that the KDF used for CMS RecipientInfo process MAY be different than the KDF used within the Composite ML-KEM Algorithm, which MAY be different than the KDFs (if any) used within the component KEMs of the Composite ML-KEM Algorithm.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<p id="section-6.3-7"><code>kekLength</code> is the size of the key-encryption key in octets.<a href="#section-6.3-7" class="pilcrow">¶</a></p>
<p id="section-6.3-8"><code>ukm</code> is an optional random input to the key-derivation function.<a href="#section-6.3-8" class="pilcrow">¶</a></p>
<p id="section-6.3-9"><code>wrap</code> identifies a key-encryption algorithm used to encrypt the keying material.<a href="#section-6.3-9" class="pilcrow">¶</a></p>
<p id="section-6.3-10"><code>encryptedKey</code> is the result of encrypting the keying material with the key-encryption key. When used with the CMS enveloped-data content type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, the keying material is a content-encryption key. When used with the CMS authenticated-data content type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, the keying material is a message-authentication key. When used with the CMS authenticated-enveloped-data content type <span>[<a href="#RFC5083" class="cite xref">RFC5083</a>]</span>, the keying material is a content-authenticated-encryption key.<a href="#section-6.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-conventions">
<section id="section-6.4">
        <h3 id="name-certificate-conventions">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-certificate-conventions" class="section-name selfRef">Certificate Conventions</a>
        </h3>
<p id="section-6.4-1">The conventions specified in this section augment RFC 5280 <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">The willingness to accept a Composite ML-KEM Algorithm MAY be signaled by the use of the SMIMECapabilities Attribute as specified in Section 2.5.2. of <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> or the SMIMECapabilities certificate extension as specified in <span>[<a href="#RFC4262" class="cite xref">RFC4262</a>]</span>.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">The intended application for the public key MAY be indicated in the key usage certificate extension as specified in Section 4.2.1.3 of <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. If the keyUsage extension is present in a certificate that conveys a Composite ML-KEM public key, then the key usage extension MUST contain only the following value:<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">keyEncipherment<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">The digitalSignature and dataEncipherment values MUST NOT be present. That is, a public key intended to be employed only with a Composite ML-KEM algorithm MUST NOT also be employed for data encryption or for digital signatures. This requirement does not carry any particular security consideration; only the convention that KEM keys be identified with the <code>keyEncipherment</code> key usage.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="smimecapabilities-attribute-conventions">
<section id="section-6.5">
        <h3 id="name-smimecapabilities-attribute">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-smimecapabilities-attribute" class="section-name selfRef">SMIMECapabilities Attribute Conventions</a>
        </h3>
<p id="section-6.5-1">Section 2.5.2 of <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> defines the SMIMECapabilities attribute to announce a partial list of algorithms that an S/MIME implementation can support. When constructing a CMS signed-data content type <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, a compliant implementation MAY include the SMIMECapabilities attribute that announces support for the RSA-OAEP Algorithm.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">The SMIMECapability SEQUENCE representing a Composite ML-KEM Algorithm MUST include the appropriate object identifier as per <a href="#tab-kem-algs" class="auto internal xref">Table 2</a> in the capabilityID field.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-asn1-module">
<section id="section-7">
      <h2 id="name-asn1-module">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-asn1-module" class="section-name selfRef">ASN.1 Module</a>
      </h2>
<div class="breakable lang-ASN.1 sourcecode" id="section-7-1">
<pre>
&lt;CODE STARTS&gt;

Composite-MLKEM-2024
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-composite-mlkem-2024(TBDMOD) }

DEFINITIONS IMPLICIT TAGS ::= BEGIN

EXPORTS ALL;

IMPORTS

PUBLIC-KEY, AlgorithmIdentifier{}, SMIME-CAPS
  FROM AlgorithmInformation-2009  -- RFC 5912 [X509ASN1]
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-algorithmInformation-02(58) }

KEM-ALGORITHM
  FROM KEMAlgorithmInformation-2023
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-kemAlgorithmInformation-2023(99) }

SubjectPublicKeyInfo
  FROM PKIX1Explicit-2009
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-pkix1-explicit-02(51) }

OneAsymmetricKey
    FROM AsymmetricKeyPackageModuleV1
      { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
        pkcs-9(9) smime(16) modules(0)
        id-mod-asymmetricKeyPkgV1(50) }

RSAPublicKey, ECPoint
  FROM PKIXAlgs-2009
    { iso(1) identified-organization(3) dod(6)
      internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkix1-algorithms2008-02(56) }

;


--
-- Object Identifiers
--

-- Defined in ITU-T X.690
der OBJECT IDENTIFIER ::=
  {joint-iso-itu-t asn1(1) ber-derived(2) distinguished-encoding(1)}


-- Just for testing, to be assigned by IANA
id-raw-key OBJECT IDENTIFIER ::= {
   joint-iso-itu-t(2) country(16) us(840) organization(1)
   entrust(114027) algorithm(80) composite(8) raw(999) 1 }

--
-- Composite KEM basic structures
--

CompositeKEMPublicKey ::= SEQUENCE SIZE (2) OF BIT STRING

CompositeKEMPublicKeyOs ::= OCTET STRING (CONTAINING
                                CompositeKEMPublicKey ENCODED BY der)

CompositeKEMPublicKeyBs ::= BIT STRING (CONTAINING
                                CompositeKEMPublicKey ENCODED BY der)

CompositeKEMPrivateKey ::= SEQUENCE SIZE (2) OF OneAsymmetricKey

CompositeCiphertextValue ::= SEQUENCE SIZE (2) OF OCTET STRING

RsaCompositeKemPublicKey ::= SEQUENCE {
        firstPublicKey BIT STRING (ENCODED BY id-raw-key),
        secondPublicKey BIT STRING (CONTAINING RSAPublicKey)
      }

EcCompositeKemPublicKey ::= SEQUENCE {
        firstPublicKey BIT STRING (ENCODED BY id-raw-key),
        secondPublicKey BIT STRING (CONTAINING ECPoint)
      }

EdCompositeKemPublicKey ::= SEQUENCE {
        firstPublicKey BIT STRING (ENCODED BY id-raw-key),
        secondPublicKey BIT STRING (ENCODED BY id-raw-key)
      }

--
-- Information Object Classes
--

pk-CompositeKEM {OBJECT IDENTIFIER:id, PublicKeyType}
  PUBLIC-KEY ::= {
    IDENTIFIER id
    KEY PublicKeyType
    PARAMS ARE absent
    CERT-KEY-USAGE { keyEncipherment }
  }

kema-CompositeKEM {OBJECT IDENTIFIER:id,
    PUBLIC-KEY:publicKeyType }
    KEM-ALGORITHM ::= {
         IDENTIFIER id
         VALUE CompositeCiphertextValue
         PARAMS ARE absent
         PUBLIC-KEYS { publicKeyType }
         SMIME-CAPS { IDENTIFIED BY id }
      }



--
-- Composite KEM Algorithms
--


-- TODO: OID to be replaced by IANA
id-MLKEM768-RSA2048 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) algorithm(80) explicitcomposite(5) kem(2) 21 }

pk-MLKEM768-RSA2048 PUBLIC-KEY ::=
  pk-CompositeKEM {
    id-MLKEM512-RSA2048,
    RsaCompositeKemPublicKey }

kema-MLKEM768-RSA2048 KEM-ALGORITHM ::=
    kema-CompositeKEM{
      id-MLKEM512-RSA2048,
      pk-MLKEM512-RSA2048 }



-- TODO: OID to be replaced by IANA
id-MLKEM768-RSA3072 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) algorithm(80) explicitcomposite(5) kem(2) 22 }

pk-MLKEM768-RSA3072 PUBLIC-KEY ::=
  pk-CompositeKEM {
    id-MLKEM512-RSA3072,
    RsaCompositeKemPublicKey }

kema-MLKEM768-RSA3072 KEM-ALGORITHM ::=
    kema-CompositeKEM{
      id-MLKEM512-RSA3072,
      pk-MLKEM512-RSA3072 }



-- TODO: OID to be replaced by IANA
id-MLKEM768-RSA4096 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) algorithm(80) explicitcomposite(5) kem(2) 23 }

pk-MLKEM768-RSA4096 PUBLIC-KEY ::=
  pk-CompositeKEM {
    id-MLKEM768-RSA4096,
    RsaCompositeKemPublicKey }

kema-MLKEM768-RSA4096 KEM-ALGORITHM ::=
    kema-CompositeKEM{
      id-MLKEM768-RSA4096,
      pk-MLKEM768-RSA4096 }


-- TODO: OID to be replaced by IANA
id-MLKEM768-ECDH-P384 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) algorithm(80) explicitcomposite(5) kem(2) 25 }

pk-MLKEM768-ECDH-P384 PUBLIC-KEY ::=
  pk-CompositeKEM {
    id-MLKEM768-ECDH-P384,
    EcCompositeKemPublicKey }

kema-MLKEM768-ECDH-P384 KEM-ALGORITHM ::=
    kema-CompositeKEM{
      id-MLKEM768-ECDH-P384,
      pk-MLKEM768-ECDH-P384 }


-- TODO: OID to be replaced by IANA
id-MLKEM768-ECDH-brainpoolP256r1 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) algorithm(80) explicitcomposite(5) kem(2) 26 }

pk-MLKEM768-ECDH-brainpoolP256r1 PUBLIC-KEY ::=
  pk-CompositeKEM {
    id-MLKEM768-ECDH-brainpoolP256r1,
    EcCompositeKemPublicKey }

kema-MLKEM768-ECDH-brainpoolP256r1 KEM-ALGORITHM ::=
    kema-CompositeKEM{
      id-MLKEM768-ECDH-brainpoolP256r1,
      pk-MLKEM768-ECDH-brainpoolP256r1 }


-- TODO: OID to be replaced by IANA
id-MLKEM768-X25519 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) algorithm(80) explicitcomposite(5) kem(2) 24 }

pk-MLKEM768-X25519 PUBLIC-KEY ::=
  pk-CompositeKEM {
    id-MLKEM768-X25519,
    EdCompositeKemPublicKey }

kema-MLKEM768-X25519 KEM-ALGORITHM ::=
    kema-CompositeKEM{
      id-MLKEM768-X25519,
      pk-MLKEM768-X25519 }



-- TODO: OID to be replaced by IANA
id-MLKEM1024-ECDH-P384 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) algorithm(80) explicitcomposite(5) kem(2) 27 }

pk-MLKEM1024-ECDH-P384 PUBLIC-KEY ::=
  pk-CompositeKEM {
    id-MLKEM1024-ECDH-P384,
    EcCompositeKemPublicKey }

kema-MLKEM1024-ECDH-P384 KEM-ALGORITHM ::=
    kema-CompositeKEM{
      id-MLKEM1024-ECDH-P384,
      pk-MLKEM1024-ECDH-P384 }


-- TODO: OID to be replaced by IANA
id-MLKEM1024-ECDH-brainpoolP384r1 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) algorithm(80) explicitcomposite(5) kem(2) 28 }

pk-MLKEM1024-ECDH-brainpoolP384r1 PUBLIC-KEY ::=
  pk-CompositeKEM{
    id-MLKEM1024-ECDH-brainpoolP384r1,
    EcCompositeKemPublicKey }

kema-MLKEM1024-ECDH-brainpoolP384r1 KEM-ALGORITHM ::=
    kema-CompositeKEM{
      id-MLKEM1024-ECDH-brainpoolP384r1,
      pk-MLKEM1024-ECDH-brainpoolP384r1 }


-- TODO: OID to be replaced by IANA
id-MLKEM1024-X448 OBJECT IDENTIFIER ::= {
  joint-iso-itu-t(2) country(16) us(840) organization(1)
  entrust(114027) algorithm(80) explicitcomposite(5) kem(2) 29 }

pk-MLKEM1024-X448 PUBLIC-KEY ::=
  pk-CompositeKEM {
    id-MLKEM1024-X448,
    EdCompositeKemPublicKey }

kema-MLKEM1024-X448 KEM-ALGORITHM ::=
    kema-CompositeKEM{
      id-MLKEM1024-X448,
      pk-MLKEM1024-X448 }


--
-- Expand the S/MIME capabilities set used by CMS [RFC5911]
--

SMimeCaps SMIME-CAPS ::=
    { kema-MLKEM512-ECDH-P256-KMAC128.&amp;smimeCaps |
      kema-MLKEM512-ECDH-brainpoolP256r1-KMAC128.&amp;smimeCaps |
      kema-MLKEM512-X25519-KMAC128.&amp;smimeCaps |
      kema-MLKEM512-RSA2048-KMAC128.&amp;smimeCaps |
      kema-MLKEM512-RSA3072-KMAC128.&amp;smimeCaps |
      kema-MLKEM768-ECDH-P256-KMAC256.&amp;smimeCaps |
      kema-MLKEM768-ECDH-brainpoolP256r1-KMAC256.&amp;smimeCaps |
      kema-MLKEM768-X25519-KMAC256.&amp;smimeCaps |
      kema-MLKEM1024-ECDH-P384-KMAC256.&amp;smimeCaps |
      kema-MLKEM1024-ECDH-brainpoolP384r1-KMAC256.&amp;smimeCaps |
      kema-MLKEM1024-X448-KMAC256.&amp;smimeCaps,
      ... }

END

&lt;CODE ENDS&gt;

</pre><a href="#section-7-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-iana">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="object-identifier-allocations">
<section id="section-8.1">
        <h3 id="name-object-identifier-allocatio">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-object-identifier-allocatio" class="section-name selfRef">Object Identifier Allocations</a>
        </h3>
<p id="section-8.1-1">EDNOTE to IANA: OIDs will need to be replaced in both the ASN.1 module and in <a href="#tab-kem-algs" class="auto internal xref">Table 2</a>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<div id="module-registration-smi-security-for-pkix-module-identifier">
<section id="section-8.1.1">
          <h4 id="name-module-registration-smi-sec">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-module-registration-smi-sec" class="section-name selfRef">Module Registration - SMI Security for PKIX Module Identifier</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.1.1-1.1">
              <p id="section-8.1.1-1.1.1">Decimal: IANA Assigned - <strong>Replace TBDMOD</strong><a href="#section-8.1.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.1-1.2">
              <p id="section-8.1.1-1.2.1">Description: Composite-KEM-2023 - id-mod-composite-kems<a href="#section-8.1.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.1-1.3">
              <p id="section-8.1.1-1.3.1">References: This Document<a href="#section-8.1.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="object-identifier-registrations-smi-security-for-pkix-algorithms">
<section id="section-8.1.2">
          <h4 id="name-object-identifier-registrat">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-object-identifier-registrat" class="section-name selfRef">Object Identifier Registrations - SMI Security for PKIX Algorithms</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.1">
              <p id="section-8.1.2-1.1.1">id-raw-key<a href="#section-8.1.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.2-1.2">
              <p id="section-8.1.2-1.2.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.2-1.3">
              <p id="section-8.1.2-1.3.1">Description: Designates a public key BIT STRING with no ASN.1 structure.<a href="#section-8.1.2-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.2-1.4">
              <p id="section-8.1.2-1.4.1">References: This Document<a href="#section-8.1.2-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.1.2-1.5">
              <p id="section-8.1.2-1.5.1">id-MLKEM768-RSA2048<a href="#section-8.1.2-1.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.5.2.1">
                  <p id="section-8.1.2-1.5.2.1.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.5.2.2">
                  <p id="section-8.1.2-1.5.2.2.1">Description: id-MLKEM768-RSA2048<a href="#section-8.1.2-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.5.2.3">
                  <p id="section-8.1.2-1.5.2.3.1">References: This Document<a href="#section-8.1.2-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-8.1.2-1.6">
              <p id="section-8.1.2-1.6.1">id-MLKEM768-RSA3072<a href="#section-8.1.2-1.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.6.2.1">
                  <p id="section-8.1.2-1.6.2.1.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.6.2.2">
                  <p id="section-8.1.2-1.6.2.2.1">Description: id-MLKEM768-RSA3072<a href="#section-8.1.2-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.6.2.3">
                  <p id="section-8.1.2-1.6.2.3.1">References: This Document<a href="#section-8.1.2-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-8.1.2-1.7">
              <p id="section-8.1.2-1.7.1">id-MLKEM768-RSA4096<a href="#section-8.1.2-1.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.7.2.1">
                  <p id="section-8.1.2-1.7.2.1.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.7.2.2">
                  <p id="section-8.1.2-1.7.2.2.1">Description: id-MLKEM768-RSA4096<a href="#section-8.1.2-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.7.2.3">
                  <p id="section-8.1.2-1.7.2.3.1">References: This Document<a href="#section-8.1.2-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-8.1.2-1.8">
              <p id="section-8.1.2-1.8.1">id-MLKEM768-ECDH-P384<a href="#section-8.1.2-1.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.8.2.1">
                  <p id="section-8.1.2-1.8.2.1.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.8.2.2">
                  <p id="section-8.1.2-1.8.2.2.1">Description: id-MLKEM768-ECDH-P384<a href="#section-8.1.2-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.8.2.3">
                  <p id="section-8.1.2-1.8.2.3.1">References: This Document<a href="#section-8.1.2-1.8.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-8.1.2-1.9">
              <p id="section-8.1.2-1.9.1">id-MLKEM768-ECDH-brainpoolP256r1<a href="#section-8.1.2-1.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.9.2.1">
                  <p id="section-8.1.2-1.9.2.1.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.9.2.2">
                  <p id="section-8.1.2-1.9.2.2.1">Description: id-MLKEM768-ECDH-brainpoolP256r1<a href="#section-8.1.2-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.9.2.3">
                  <p id="section-8.1.2-1.9.2.3.1">References: This Document<a href="#section-8.1.2-1.9.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-8.1.2-1.10">
              <p id="section-8.1.2-1.10.1">id-MLKEM768-X25519<a href="#section-8.1.2-1.10.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.10.2.1">
                  <p id="section-8.1.2-1.10.2.1.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.10.2.2">
                  <p id="section-8.1.2-1.10.2.2.1">Description: id-MLKEM768-X25519<a href="#section-8.1.2-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.10.2.3">
                  <p id="section-8.1.2-1.10.2.3.1">References: This Document<a href="#section-8.1.2-1.10.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-8.1.2-1.11">
              <p id="section-8.1.2-1.11.1">id-MLKEM1024-ECDH-P384<a href="#section-8.1.2-1.11.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.11.2.1">
                  <p id="section-8.1.2-1.11.2.1.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.11.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.11.2.2">
                  <p id="section-8.1.2-1.11.2.2.1">Description: id-MLKEM1024-ECDH-P384<a href="#section-8.1.2-1.11.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.11.2.3">
                  <p id="section-8.1.2-1.11.2.3.1">References: This Document<a href="#section-8.1.2-1.11.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-8.1.2-1.12">
              <p id="section-8.1.2-1.12.1">id-MLKEM1024-ECDH-brainpoolP384r1<a href="#section-8.1.2-1.12.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.12.2.1">
                  <p id="section-8.1.2-1.12.2.1.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.12.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.12.2.2">
                  <p id="section-8.1.2-1.12.2.2.1">Description: id-MLKEM1024-ECDH-brainpoolP384r1<a href="#section-8.1.2-1.12.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.12.2.3">
                  <p id="section-8.1.2-1.12.2.3.1">References: This Document<a href="#section-8.1.2-1.12.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-8.1.2-1.13">
              <p id="section-8.1.2-1.13.1">id-MLKEM1024-X448<a href="#section-8.1.2-1.13.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1.2-1.13.2.1">
                  <p id="section-8.1.2-1.13.2.1.1">Decimal: IANA Assigned<a href="#section-8.1.2-1.13.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.13.2.2">
                  <p id="section-8.1.2-1.13.2.2.1">Description: id-MLKEM1024-X448<a href="#section-8.1.2-1.13.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-8.1.2-1.13.2.3">
                  <p id="section-8.1.2-1.13.2.3.1">References: This Document<a href="#section-8.1.2-1.13.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="sec-cons-kem-combiner">
<section id="section-9.1">
        <h3 id="name-kem-combiner-security-analy">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-kem-combiner-security-analy" class="section-name selfRef">KEM Combiner Security Analysis</a>
        </h3>
<p id="section-9.1-1">EDNOTE: the exact text to put here depends on the outcome of the CFRG KEM Combiners and X-Wing discussion. If CFRG doesn't move fast enough for us, then we may need to leverage this security consideration directly on top of the X-Wing paper <span>[<a href="#X-Wing" class="cite xref">X-Wing</a>]</span>.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">The primary security property of the KEM combiner is that it preserves IND-CCA2 of the overall Composite ML-KEM so long as at least one component is IND-CCA2 <span><a href="#GHP18" class="internal xref">X-Wing</a> [<a href="#GHP18" class="cite xref">GHP18</a>]</span>. Additionally, we also need to consider the case where one of the component algorithms is completely broken; that the private key is known to an attacker, or worse that the public key, private key, and ciphertext are maniputaled by the attacker. In this case, we rely on the construction of the KEM combiner to ensure that the value of the other shared secret cannot be leaked or the combined shared secret predicted via manipulation of the broken algorithm. The following sections continue this discussion.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<div id="sec-cons-ct-collision">
<section id="section-9.1.1">
          <h4 id="name-second-pre-image-resistance">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-second-pre-image-resistance" class="section-name selfRef">Second pre-image resistance of componet KEMs</a>
          </h4>
<p id="section-9.1.1-1">The notion of a second pre-image resistant KEM is defined in <span>[<a href="#X-Wing" class="cite xref">X-Wing</a>]</span> being the property that it is computationally difficult to find two different ciphertexts <code>c != c'</code> that will decapsulate to the same shared secret under the same public key. For the purposes of a hybrid KEM combiner, this property means that given two composite ciphertexts <code>(c1, c2)</code> and <code>(c1', c2')</code>, we must obtain a unique overall shared secret so long as either <code>c1 != c1'</code> or <code>c2 != c2'</code> -- i.e. the overall Composite ML-KEM is second pre-image resistant, and therefore secure so, long as one of the component KEMs is.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1.1-2">In <span>[<a href="#X-Wing" class="cite xref">X-Wing</a>]</span> it is proven that ML-KEM is a second pre-image resistant KEM and therefore the ML-KEM ciphertext can safely be omitted from the KEM combiner. Note that this makes a fundamental assumption on ML-KEM remaining ciphertext second pre-image resistant, and thefore this formulation of KEM combiner does not fully protect against implementation errors in the ML-KEM component -- particularly around the ciphertext check step of the Fujisaki-Okamoto transform -- which could trivially lead to second ciphertext pre-image attacks that break the IND-CCA2 security of the ML-KEM component and of the overall Composite ML-KEM. This could be more fully mitigated by binding the ML-KEM ciphertext in the combiner, but a design decision was made to settle for protection against algorithmic attacks and not implementation attacks against ML-KEM in order to increase performance.<a href="#section-9.1.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1.1-3">However, since neither RSA-OAEP nor ECDH guarantee second pre-image resistance at all, even in a correct implementation, these ciphertexts are bound to the key derivation in order to guarantee that <code>c != c'</code> will yield a unique ciphertext, and thus restoring second pre-image resistance to the overall Composite ML-KEM.<a href="#section-9.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sha3-vs-hkdf-sha2">
<section id="section-9.1.2">
          <h4 id="name-sha3-vs-hkdf-sha2">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-sha3-vs-hkdf-sha2" class="section-name selfRef">SHA3 vs HKDF-SHA2</a>
          </h4>
<p id="section-9.1.2-1">In order to achieve the desired secutiy property that the Composite ML-KEM is IND-CCA2 whenever at least one of the component KEMs is, the KDF used in the KEM combiner needs to possess collision and second pre-image resistance with respect to each of its inputs independently; a property sometimes called "dual-PRF" <span>[<a href="#Aviram22" class="cite xref">Aviram22</a>]</span>. Collision and second-pre-image resistance protects against compromise of one component algorithm from resulting in the ability to construct multiple different ciphertexts which result in the same shared secret. Pre-image resistance protects against compromise of one component algorithm being used to attack and learn the value of the other shared secret.<a href="#section-9.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.1.2-2">SHA3 is known to have all of the necessary dual-PRF properties <span>[<a href="#X-Wing" class="cite xref">X-Wing</a>]</span>, but SHA2 does not and therefore all SHA2-based constructions MUST use SHA2 within an HMAC construction such as HKDF-SHA2 <span>[<a href="#GHP18" class="cite xref">GHP18</a>]</span>.<a href="#section-9.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generifying-this-construction">
<section id="section-9.1.3">
          <h4 id="name-generifying-this-constructi">
<a href="#section-9.1.3" class="section-number selfRef">9.1.3. </a><a href="#name-generifying-this-constructi" class="section-name selfRef">Generifying this construction</a>
          </h4>
<p id="section-9.1.3-1">It should be cleart that the security analsis of the presented KEM combiner construction relies heavily on the specific choices of component algorithms and combiner KDF, and this combiner construction SHOULD NOT by applied to any other combination of ciphers without performing the appropriate security analysis.<a href="#section-9.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-key-reuse">
<section id="section-9.1.4">
          <h4 id="name-key-reuse">
<a href="#section-9.1.4" class="section-number selfRef">9.1.4. </a><a href="#name-key-reuse" class="section-name selfRef">Key Reuse</a>
          </h4>
<p id="section-9.1.4-1">When using single-algorithm cryptography, the best practice is to always generate fresh keying material for each purpose, for example when renewing a certificate, or obtaining both a TLS and S/MIME certificate for the same device, however in practice key reuse in such scenarios is not always catastrophic to security and therefore often tolerated. With composite keys we have a much stricter security requirement. However this reasoning does not hold in the PQ / Tradational hybrid setting.<a href="#section-9.1.4-1" class="pilcrow">¶</a></p>
<p id="section-9.1.4-2">Within the broader context of PQ / Traditional hybrids, we need to consider new attack surfaces that arise due to the hybrid constructions and did not exist in single-algorithm contexts. One of these is key reuse where the component keys within a hybrid are also used by themselves within a single-algorithm context. For example, it might be tempting for an operator to take already-deployed RSA keys and add an ML-KEM key to them to form a hybrid. Within a hybrid signature context this leads to a class of attacks referred to as "stripping attacks" where one component signature can be extracted and presented as a single-algorithm signature. Hybrid KEMs using a contacenation-style KEM combiner, as is done in this document, do not have the analagous attack surface because even if an attacker is able to extract and decrypt one of the component ciphertexts, this will yield a different shared secret than the overall shared secret derived from the composite, so any subsequent symmetric cryptographic operations will fail. However there is still a risk of key reuse which relates to certificate revocation, as well as general key reuse security issues.<a href="#section-9.1.4-2" class="pilcrow">¶</a></p>
<p id="section-9.1.4-3">Upon receiving a new certificate enrollment request, many certification authorities will check if the requested public key has been previously revoked due to key compromise. Often a CA will perform this check by using the public key hash. Therefore, even if both components of a composite have been previously revoked, the CA may only check the hash of the combined composite key and not find the revocations. Therefore, it is RECOMMENDED to avoid key reuse and always generate fresh component keys for a new composite. It is also RECOMMENDED that CAs performing revocation checks on a composite key should also check both component keys independently.<a href="#section-9.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="policy-for-deprecated-and-acceptable-algorithms">
<section id="section-9.2">
        <h3 id="name-policy-for-deprecated-and-a">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-policy-for-deprecated-and-a" class="section-name selfRef">Policy for Deprecated and Acceptable Algorithms</a>
        </h3>
<p id="section-9.2-1">Traditionally, a public key or certificate contains a single cryptographic algorithm. If and when an algorithm becomes deprecated (for example, RSA-512, or SHA1), the path to deprecating it and removing it from operational environments is, at least is principle, straightforward.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">In the composite model this is less obvious since implementers may decide that certain cryptographic algorithms have complementary security properties and are acceptable in combination even though one or both algorithms are deprecated for individual use. As such, a single composite public key or certificate may contain a mixture of deprecated and non-deprecated algorithms.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">Since composite algorithms are registered independently of their component algorithms, their deprecation can be handled independently from that of their component algorithms. For example a cryptographic policy might continue to allow <code>id-MLKEM512-ECDH-P256</code> even after ECDH-P256 is deprecated.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">The Composite ML-KEM design specified in this document, and especially that of the KEM combiner specified in <a href="#sec-kem-combiner" class="auto internal xref">Section 2.3.4</a> means that the overall Composite ML-KEM algorithm should be considered to have the security strength of the strongest of its component algorithms; ie as long as one component algorithm remains strong, then the overall composite algorithm remains strong.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BSI-ECC">[BSI-ECC]</dt>
        <dd>
<span class="refAuthor">Federal Office for Information Security (BSI)</span>, <span class="refTitle">"Technical Guideline BSI TR-03111: Elliptic Curve Cryptography. Version 2.10"</span>, <time datetime="2018-06-01" class="refDate">1 June 2018</time>. </dd>
<dd class="break"></dd>
<dt id="FIPS.180-4">[FIPS.180-4]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"FIPS Publication 180-4: Secure Hash Standard"</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS.202">[FIPS.202]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions"</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS.203">[FIPS.203]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Module-Lattice-based Key-Encapsulation Mechanism Standard"</span>, <time datetime="2024-08" class="refDate">August 2024</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-cms-sha3-hash">[I-D.ietf-lamps-cms-sha3-hash]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Use of the SHA3 One-way Hash Functions in the Cryptographic Message Syntax (CMS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-cms-sha3-hash-04</span>, <time datetime="2024-05-16" class="refDate">16 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-sha3-hash-04">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-sha3-hash-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-kyber-certificates">[I-D.ietf-lamps-kyber-certificates]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Kampanakis, P.</span>, <span class="refAuthor">Massimo, J.</span>, and <span class="refAuthor">B. Westerbaan</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure - Algorithm Identifiers for Kyber"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-kyber-certificates-01</span>, <time datetime="2023-03-28" class="refDate">28 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-kyber-certificates-01">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-kyber-certificates-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4055">[RFC4055]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Kaliski, B.</span>, and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 4055</span>, <span class="seriesInfo">DOI 10.17487/RFC4055</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4055">https://www.rfc-editor.org/info/rfc4055</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5958">[RFC5958]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Asymmetric Key Packages"</span>, <span class="seriesInfo">RFC 5958</span>, <span class="seriesInfo">DOI 10.17487/RFC5958</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5958">https://www.rfc-editor.org/info/rfc5958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8410">[RFC8410]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure"</span>, <span class="seriesInfo">RFC 8410</span>, <span class="seriesInfo">DOI 10.17487/RFC8410</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8410">https://www.rfc-editor.org/info/rfc8410</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8411">[RFC8411]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Andrews</span>, <span class="refTitle">"IANA Registration for the Cryptographic Algorithm Object Identifier Range"</span>, <span class="seriesInfo">RFC 8411</span>, <span class="seriesInfo">DOI 10.17487/RFC8411</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8411">https://www.rfc-editor.org/info/rfc8411</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8619">[RFC8619]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Algorithm Identifiers for the HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 8619</span>, <span class="seriesInfo">DOI 10.17487/RFC8619</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8619">https://www.rfc-editor.org/info/rfc8619</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9629">[RFC9629]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Gray, J.</span>, and <span class="refAuthor">T. Okubo</span>, <span class="refTitle">"Using Key Encapsulation Mechanism (KEM) Algorithms in the Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 9629</span>, <span class="seriesInfo">DOI 10.17487/RFC9629</span>, <time datetime="2024-08" class="refDate">August 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9629">https://www.rfc-editor.org/info/rfc9629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP.800-56Ar3">[SP.800-56Ar3]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP.800-56Cr2">[SP.800-56Cr2]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Recommendation for Key-Derivation Methods in Key-Establishment Schemes"</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Cr2.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Cr2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP.800-57pt1r5">[SP.800-57pt1r5]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Recommendation for Key Management: Part 1 – General"</span>, <time datetime="2020-05" class="refDate">May 2020</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1:2015</span>, <time datetime="2015-11" class="refDate">November 2015</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ANSSI2024">[ANSSI2024]</dt>
        <dd>
<span class="refAuthor">French Cybersecurity Agency (ANSSI)</span>, <span class="refAuthor">Federal Office for Information Security (BSI)</span>, <span class="refAuthor">Netherlands National Communications Security Agency (NLNCSA)</span>, and <span class="refAuthor">Swedish National Communications Security Authority, Swedish Armed Forces</span>, <span class="refTitle">"Position Paper on Quantum Key Distribution"</span>, <span>n.d.</span>, <span>&lt;<a href="https://cyber.gouv.fr/sites/default/files/document/Quantum_Key_Distribution_Position_Paper.pdf">https://cyber.gouv.fr/sites/default/files/document/Quantum_Key_Distribution_Position_Paper.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Aviram22">[Aviram22]</dt>
        <dd>
<span class="refAuthor">Yogev, E.</span>, <span class="refTitle">"Practical (Post-Quantum) Key Combiners from One-Wayness and Applications to TLS"</span>, <span>n.d.</span>, <span>&lt;<a href="https://eprint.iacr.org/2022/065">https://eprint.iacr.org/2022/065</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BSI2021">[BSI2021]</dt>
        <dd>
<span class="refAuthor">Federal Office for Information Security (BSI)</span>, <span class="refTitle">"Quantum-safe cryptography - fundamentals, current developments and recommendations"</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Brochure/quantum-safe-cryptography.pdf">https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/Brochure/quantum-safe-cryptography.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CNSA2.0">[CNSA2.0]</dt>
        <dd>
<span class="refTitle">"Commercial National Security Algorithm Suite 2.0"</span>, <span>n.d.</span>, <span>&lt;<a href="https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF">https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS-140-3-IG">[FIPS-140-3-IG]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology (NIST)</span>, <span class="refTitle">"Implementation Guidance for FIPS 140-3 and the Cryptographic Module Validation Program"</span>, <time datetime="2024-07" class="refDate">July 2024</time>, <span>&lt;<a href="https://csrc.nist.gov/csrc/media/Projects/cryptographic-module-validation-program/documents/fips%20140-3/FIPS%20140-3%20IG.pdf">https://csrc.nist.gov/csrc/media/Projects/cryptographic-module-validation-program/documents/fips%20140-3/FIPS%20140-3%20IG.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GHP18">[GHP18]</dt>
        <dd>
<span class="refAuthor">Poettering, B.</span>, <span class="refTitle">"KEM Combiners"</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://eprint.iacr.org/2018/024">https://eprint.iacr.org/2018/024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-cms-kyber">[I-D.ietf-lamps-cms-kyber]</dt>
        <dd>
<span class="refAuthor">Prat, J.</span>, <span class="refAuthor">Ounsworth, M.</span>, and <span class="refAuthor">D. Van Geest</span>, <span class="refTitle">"Use of ML-KEM in the Cryptographic Message Syntax (CMS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-cms-kyber-05</span>, <time datetime="2024-10-15" class="refDate">15 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-kyber-05">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-cms-kyber-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-pquip-hybrid-signature-spectrums">[I-D.ietf-pquip-hybrid-signature-spectrums]</dt>
        <dd>
<span class="refAuthor">Bindel, N.</span>, <span class="refAuthor">Hale, B.</span>, <span class="refAuthor">Connolly, D.</span>, and <span class="refAuthor">F. D</span>, <span class="refTitle">"Hybrid signature spectrums"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-pquip-hybrid-signature-spectrums-00</span>, <time datetime="2024-05-24" class="refDate">24 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-pquip-hybrid-signature-spectrums-00">https://datatracker.ietf.org/doc/html/draft-ietf-pquip-hybrid-signature-spectrums-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-pquip-pqt-hybrid-terminology">[I-D.ietf-pquip-pqt-hybrid-terminology]</dt>
        <dd>
<span class="refAuthor">D, F.</span>, <span class="refAuthor">P, M.</span>, and <span class="refAuthor">B. Hale</span>, <span class="refTitle">"Terminology for Post-Quantum Traditional Hybrid Schemes"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-pquip-pqt-hybrid-terminology-04</span>, <time datetime="2024-09-10" class="refDate">10 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-pquip-pqt-hybrid-terminology-04">https://datatracker.ietf.org/doc/html/draft-ietf-pquip-pqt-hybrid-terminology-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-hybrid-design">[I-D.ietf-tls-hybrid-design]</dt>
        <dd>
<span class="refAuthor">Stebila, D.</span>, <span class="refAuthor">Fluhrer, S.</span>, and <span class="refAuthor">S. Gueron</span>, <span class="refTitle">"Hybrid key exchange in TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-hybrid-design-04</span>, <time datetime="2022-01-11" class="refDate">11 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-hybrid-design-04">https://datatracker.ietf.org/doc/html/draft-ietf-tls-hybrid-design-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4210">[RFC4210]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Kause, T.</span>, and <span class="refAuthor">T. Mononen</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 4210</span>, <span class="seriesInfo">DOI 10.17487/RFC4210</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4210">https://www.rfc-editor.org/info/rfc4210</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4211">[RFC4211]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4211">https://www.rfc-editor.org/info/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4262">[RFC4262]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refTitle">"X.509 Certificate Extension for Secure/Multipurpose Internet Mail Extensions (S/MIME) Capabilities"</span>, <span class="seriesInfo">RFC 4262</span>, <span class="seriesInfo">DOI 10.17487/RFC4262</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4262">https://www.rfc-editor.org/info/rfc4262</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5083">[RFC5083]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS) Authenticated-Enveloped-Data Content Type"</span>, <span class="seriesInfo">RFC 5083</span>, <span class="seriesInfo">DOI 10.17487/RFC5083</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5083">https://www.rfc-editor.org/info/rfc5083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5639">[RFC5639]</dt>
        <dd>
<span class="refAuthor">Lochter, M.</span> and <span class="refAuthor">J. Merkle</span>, <span class="refTitle">"Elliptic Curve Cryptography (ECC) Brainpool Standard Curves and Curve Generation"</span>, <span class="seriesInfo">RFC 5639</span>, <span class="seriesInfo">DOI 10.17487/RFC5639</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5639">https://www.rfc-editor.org/info/rfc5639</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5914">[RFC5914]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Ashmore, S.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"Trust Anchor Format"</span>, <span class="seriesInfo">RFC 5914</span>, <span class="seriesInfo">DOI 10.17487/RFC5914</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5914">https://www.rfc-editor.org/info/rfc5914</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5990">[RFC5990]</dt>
        <dd>
<span class="refAuthor">Randall, J.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Brainard, J.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Use of the RSA-KEM Key Transport Algorithm in the Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 5990</span>, <span class="seriesInfo">DOI 10.17487/RFC5990</span>, <time datetime="2010-09" class="refDate">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5990">https://www.rfc-editor.org/info/rfc5990</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6090">https://www.rfc-editor.org/info/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7292">[RFC7292]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Nystrom, M.</span>, <span class="refAuthor">Parkinson, S.</span>, <span class="refAuthor">Rusch, A.</span>, and <span class="refAuthor">M. Scott</span>, <span class="refTitle">"PKCS #12: Personal Information Exchange Syntax v1.1"</span>, <span class="seriesInfo">RFC 7292</span>, <span class="seriesInfo">DOI 10.17487/RFC7292</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7292">https://www.rfc-editor.org/info/rfc7292</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9180">[RFC9180]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="seriesInfo">RFC 9180</span>, <span class="seriesInfo">DOI 10.17487/RFC9180</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9180">https://www.rfc-editor.org/info/rfc9180</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-131Ar2">[SP800-131Ar2]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span> and <span class="refAuthor">A. Roginksy</span>, <span class="refTitle">"Transitioning the Use of Cryptographic Algorithms and Key Lengths"</span>, <span>n.d.</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-131ar2.pdf">https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-131ar2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X-Wing">[X-Wing]</dt>
      <dd>
<span class="refAuthor">Barbosa, M.</span>, <span class="refAuthor">Connolly, D.</span>, <span class="refAuthor">Duarte, J.</span>, <span class="refAuthor">Kaiser, A.</span>, <span class="refAuthor">Schwabe, P.</span>, <span class="refAuthor">Varner, K.</span>, and <span class="refAuthor">B. Westerbaan</span>, <span class="refTitle">"X-Wing The Hybrid KEM You’ve Been Looking For"</span>, <time datetime="2024-01-09" class="refDate">9 January 2024</time>, <span>&lt;<a href="https://eprint.iacr.org/2024/039.pdf">https://eprint.iacr.org/2024/039.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="appdx-samples">
<section id="appendix-A">
      <h2 id="name-samples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-samples" class="section-name selfRef">Samples</a>
      </h2>
<p id="appendix-A-1">TBD<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fixed-component-algorithm-identifiers">
<section id="appendix-B">
      <h2 id="name-fixed-component-algorithm-i">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-fixed-component-algorithm-i" class="section-name selfRef">Fixed Component Algorithm Identifiers</a>
      </h2>
<p id="appendix-B-1">The following table lists explicitly the DER encoded <code>AlgorithmID</code> that MUST be used when reconstructing <code>SubjectPublicKeyInfo</code> objects for each component public key, which may be required for example if cryptographic library requires the public key in this form in order to process each component algorithm. The public key <code>BIT STRING</code> should be taken directly from the respective component of the CompositeKEMPublicKey.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<table class="center" id="table-6">
        <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Composite KEM</th>
            <th class="text-left" rowspan="1" colspan="1">First AlgorithmID</th>
            <th class="text-left" rowspan="1" colspan="1">Second AlgorithmID</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TODO</td>
            <td class="text-left" rowspan="1" colspan="1">TODO</td>
            <td class="text-left" rowspan="1" colspan="1">TODO</td>
          </tr>
        </tbody>
      </table>
<p id="appendix-B-3">TODO: see https://github.com/lamps-wg/draft-composite-kem/issues/20<a href="#appendix-B-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-in-pract">
<section id="appendix-C">
      <h2 id="name-implementation-consideratio">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<div id="sec-fips">
<section id="appendix-C.1">
        <h3 id="name-fips-certification">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-fips-certification" class="section-name selfRef">FIPS Certification</a>
        </h3>
<p id="appendix-C.1-1">One of the primary design goals of this specification is for the overall composite algorithm to be able to be considered FIPS-approved even when one of the component algorithms is not. Implementers seeking FIPS certification of a Composite ML-KEM algorithm where only one of the component algorithms has been FIPS-validated or FIPS-approved should credit the FIPS-validated component algorithm with full security strength, the non-FIPS-validated component algorithm with zero security, and the overall composite should be considered full strength and thus FIPS-approved.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">The authors wish to note that this gives composite algorithms great future utility both for future cryptographic migrations as well as bridging across jurisdictions; for example defining composite algorithms which combine FIPS cryptography with cryptography from a different national standards body.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
<div id="fips-certification-of-combiner-function">
<section id="appendix-C.1.1">
          <h4 id="name-fips-certification-of-combi">
<a href="#appendix-C.1.1" class="section-number selfRef">C.1.1. </a><a href="#name-fips-certification-of-combi" class="section-name selfRef">FIPS certification of Combiner Function</a>
          </h4>
<p id="appendix-C.1.1-1">TODO: update this to NIST SP 800-227, once it is published.<a href="#appendix-C.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1.1-2">One of the primary NIST documents which is relevant for certification of a composite algorithm is NIST SP.800-56Cr2 <span>[<a href="#SP.800-56Cr2" class="cite xref">SP.800-56Cr2</a>]</span> by using the allowed "hybrid" shared secret of the form <code>Z' = Z || T</code>. Compliance is acheived in the following way:<a href="#appendix-C.1.1-2" class="pilcrow">¶</a></p>
<p id="appendix-C.1.1-3">SP.800-56Cr2 section 4 "One-Step Key Derivation" requires a <code>counter</code> which begins at the 4-byte value 0x00000001. However, the counter is allowed to be omitted when the hash function is executed only once, as specified on page 159 of the FIPS 140-3 Implementation Guidance <span>[<a href="#FIPS-140-3-IG" class="cite xref">FIPS-140-3-IG</a>]</span>.<a href="#appendix-C.1.1-3" class="pilcrow">¶</a></p>
<p id="appendix-C.1.1-4">The HKDF-SHA2 options can be certified under SP.800-56Cr2 One-Step Key Derivation Option 1: <code>H(x) = hash(x)</code>.<a href="#appendix-C.1.1-4" class="pilcrow">¶</a></p>
<p id="appendix-C.1.1-5">The SHA3 options can be certified under SP.800-56Cr2 One-Step Key Derivation Option 2: <code>H(x) = HMAC-hash(salt, x)</code> with the salt omitted.<a href="#appendix-C.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-backwards-compat">
<section id="appendix-C.2">
        <h3 id="name-backwards-compatibility">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-backwards-compatibility" class="section-name selfRef">Backwards Compatibility</a>
        </h3>
<p id="appendix-C.2-1">As noted in the introduction, the post-quantum cryptographic migration will face challenges in both ensuring cryptographic strength against adversaries of unknown capabilities, as well as providing ease of migration. The composite mechanisms defined in this document primarily address cryptographic strength, however this section contains notes on how backwards compatibility may be obtained.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<p id="appendix-C.2-2">The term "ease of migration" is used here to mean that existing systems can be gracefully transitioned to the new technology without requiring large service disruptions or expensive upgrades. The term "backwards compatibility" is used here to mean something more specific; that existing systems as they are deployed today can inter-operate with the upgraded systems of the future.<a href="#appendix-C.2-2" class="pilcrow">¶</a></p>
<p id="appendix-C.2-3">These migration and interoperability concerns need to be thought about in the context of various types of protocols that make use of X.509 and PKIX with relation to key establishment and content encryption, from online negotiated protocols such as TLS 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> and IKEv2 <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>, to non-negotiated asynchronous protocols such as S/MIME signed email <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span>, as well as myriad other standardized and proprietary protocols and applications that leverage CMS <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> encrypted structures.<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="impl-cons-decaps-pubkey">
<section id="appendix-C.3">
        <h3 id="name-decapsulation-requires-the-">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-decapsulation-requires-the-" class="section-name selfRef">Decapsulation Requires the Public Key</a>
        </h3>
<p id="appendix-C.3-1">ML-KEM always requires the public key in order to perform various steps of the Fujisaki-Okamoto decapsulation <span>[<a href="#FIPS.203" class="cite xref">FIPS.203</a>]</span>, and for this reason the private key encoding specified in FIPS 203 includes the public key. Therefore it is not required to carry it in the <code>OneAsymmetricKey.publicKey</code> field, which remains optional, but is strictly speaking redundant since an ML-KEM public key can be parsed from an ML-KEM private key, and thus populating the <code>OneAsymmetricKey.publicKey</code> field would mean that two copies of the public key data are transmitted.<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<p id="appendix-C.3-2">With regard to the traditional algorithms, RSA or Elliptic Curve, in order to achieve the public-key binding property the KEM combiner used to form the Composite ML-KEM, the combiner requires the traditional public key as input to the KDF that derives the output shared secret. Therefore it is required to carry the public key within the respective <code>OneAsymmetricKey.publicKey</code> as per the private key encoding given in <a href="#sec-priv-key" class="auto internal xref">Section 3.3</a>. Implementers who choose to use a different private key encoding than the one specified in this document MUST consider how to provide the component public keys to the decapsulate routine. While some implementations might contain routines to computationally derive the public key from the private key, it is not guaranteed that all implementations will support this; for this reason the interoparable composite private key format given in this document in <a href="#sec-priv-key" class="auto internal xref">Section 3.3</a> requires the public key of the traditional component to be included.<a href="#appendix-C.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="intellectual-property-considerations">
<section id="appendix-D">
      <h2 id="name-intellectual-property-consi">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-intellectual-property-consi" class="section-name selfRef">Intellectual Property Considerations</a>
      </h2>
<p id="appendix-D-1">The following IPR Disclosure relates to this draft:<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">https://datatracker.ietf.org/ipr/3588/<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">EDNOTE TODO: Check with Max Pala whether this IPR actually applies to this draft.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors-and-acknowledgments">
<section id="appendix-E">
      <h2 id="name-contributors-and-acknowledg">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-contributors-and-acknowledg" class="section-name selfRef">Contributors and Acknowledgments</a>
      </h2>
<p id="appendix-E-1">This document incorporates contributions and comments from a large group of experts. The Editors would especially like to acknowledge the expertise and tireless dedication of the following people, who attended many long meetings and generated millions of bytes of electronic mail and VOIP traffic over the past year in pursuit of this document:<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">Serge Mister (Entrust), Ali Noman (Entrust), Peter C. (UK NCSC), Sophie Schmieg (Google), Deirdre Connolly (SandboxAQ), Falko Strenzke (MTG AG), Dan van Geest (Crypto Next), Piotr Popis (Enigma), and
Douglas Stebila (University of Waterloo).<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<p id="appendix-E-3">We are grateful to all, including any contributors who may have
been inadvertently omitted from this list.<a href="#appendix-E-3" class="pilcrow">¶</a></p>
<p id="appendix-E-4">This document borrows text from similar documents, including those referenced below. Thanks go to the authors of those
   documents.  "Copying always makes things easier and less error prone" - <span>[<a href="#RFC8411" class="cite xref">RFC8411</a>]</span>.<a href="#appendix-E-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Ounsworth</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div dir="auto" class="left"><span class="street-address">2500 Solandt Road – Suite 100</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K2K 3G5</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mike.ounsworth@entrust.com" class="email">mike.ounsworth@entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Gray</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div dir="auto" class="left"><span class="street-address">2500 Solandt Road – Suite 100</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K2K 3G5</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.gray@entrust.com" class="email">john.gray@entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Massimiliano Pala</span></div>
<div dir="auto" class="left"><span class="org">OpenCA Labs</span></div>
<div dir="auto" class="left">
<span class="locality">New York City, New York</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:director@openca.org" class="email">director@openca.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jan Klaussner</span></div>
<div dir="auto" class="left"><span class="org">Bundesdruckerei GmbH</span></div>
<div dir="auto" class="left"><span class="street-address">Kommandantenstr. 18</span></div>
<div dir="auto" class="left">
<span class="postal-code">10969</span> <span class="locality">Berlin</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jan.klaussner@bdr.de" class="email">jan.klaussner@bdr.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Scott Fluhrer</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sfluhrer@cisco.com" class="email">sfluhrer@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
